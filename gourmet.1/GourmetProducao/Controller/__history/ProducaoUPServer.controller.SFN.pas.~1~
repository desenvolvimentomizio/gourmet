unit ProducaoUPServer.controller.SFN;

interface

implementation


-- verificar se
SELECT distinct pro.procodigo
     , pun.puncodigo
     , CONCAT(pro.pronomereduzido,' ',if(UPPER(uni.uninome)='UNIDADE','',uni.uninome),' (Sb: ',formatValor(sfnquantidade,0),')') as pronomereduzido
     , formatValor(pun.punprecoav,2) punprecoav
     , pro.unicodigo as unipro
     , pun.unicodigo as unipun
     , uni.unisimbolo
     , sfn.sfnquantidade
     , sfn.sfncodigo
  FROM pun
 INNER JOIN pro
         ON pun.procodigo = pro.procodigo
 INNER JOIN uni
         ON pun.unicodigo = uni.unicodigo
 INNER JOIN sfn
         ON pro.procodigo = sfn.procodigo
        AND uni.unicodigo = sfn.unicodigo
 WHERE (pro.tpocodigo = 0 or pro.tpocodigo = 4)
   AND pro.grpcodigo=:grpcodigo
 ORDER BY pun.punprecoav

end.
