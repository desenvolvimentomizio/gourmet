unit GourmetServer.Controller.V_CFG;

interface

Uses
  FireDAC.Phys.MySQLDef,
  FireDAC.Phys.MySQL,
  FireDAC.Phys.Intf,
  FireDAC.Phys,
  FireDAC.UI.Intf,
  FireDAC.ConsoleUI.Wait,
  Data.DB,
  FireDAC.Comp.Client,
  FireDAC.Comp.DataSet,

  System.Json,
  System.SysUtils,
  idHashMessageDigest;

function V1BuscaCodigoCfgmnfeCfoVenda: Integer;
function v1BuscaCodigoCfgmgouCtaDelivery: Integer;

type
  TAPIError = class
  private
    Ferror: string;
  public
    property error: string read Ferror write Ferror;
  end;

implementation

uses
  GourmetServer.Service.Conexoes;



function v1BuscaCodigoCfgmgouCtaDelivery: Integer;
var
  conexao:TFDconnection;
  cfg:TFDQuery;

  vlcfgmgouctadelivery: Integer;
begin
  vlcfgmgouctadelivery := 0;

  conexao:=TFDconnection.Create(nil);

  if AtivaConexao(conexao)<>nil then
  begin

      cfg:=TFDQuery.Create(nil);
      cfg.Connection:=Conexao;
      cfg.sql.Text:='select cfgmgouctadelivery from cfgmgou where cfgcodigo=1';
      cfg.Open;

      if not cfg.IsEmpty then
       vlcfgmgouctadelivery := cfg.FieldByName('cfgmgouctadelivery').asinteger
      else
       vlcfgmgouctadelivery :=1;

      cfg.close;

      if cfg<>nil then
      cfg.DisposeOf;


  end;

  if conexao<>nil then
  conexao.DisposeOf;

  result := vlcfgmgouctadelivery;

end;



function V1BuscaCodigoCfgmnfeCfoVenda: Integer;
var
  conexao:TFDconnection;
  cfg:TFDQuery;

  vlcfgtoemesinte:Integer;

begin
  vlcfgtoemesinte := 0;

  conexao:=TFDconnection.Create(nil);

  if AtivaConexao(conexao)<>nil then
  begin

      cfg:=TFDQuery.Create(nil);
      cfg.Connection:=Conexao;
      cfg.sql.Text:='select cfgtoemesinte from cfgmsai where cfgcodigo=1';
      cfg.Open;

      if not cfg.IsEmpty then
       vlcfgtoemesinte := cfg.FieldByName('cfgtoemesinte').asinteger
      else
       vlcfgtoemesinte :=1;

      cfg.close;

      if cfg<>nil then
      cfg.DisposeOf;

  end;

  result := vlcfgtoemesinte;

  if conexao<>nil then
  conexao.DisposeOf;


end;

end.
