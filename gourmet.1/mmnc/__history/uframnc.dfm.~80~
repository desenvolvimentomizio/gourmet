inherited framnc: Tframnc
  Width = 1375
  ExplicitWidth = 1375
  inherited PlGeral: TPanel
    Width = 1375
    ExplicitWidth = 1375
    inherited PlLista: TPanel
      Width = 1231
      ExplicitWidth = 1231
      inherited SplLista: TSplitter
        Top = 436
        Width = 1231
        Visible = True
        ExplicitTop = 430
        ExplicitWidth = 1231
      end
      inherited SpFilter: TSplitter
        Width = 1231
        ExplicitWidth = 1231
      end
      inherited PlRodaPe: TPanel
        Top = 441
        Width = 1231
        Height = 139
        Visible = True
        ExplicitTop = 441
        ExplicitWidth = 1231
        ExplicitHeight = 139
        object PlRodapeItens: TPanel
          Left = 0
          Top = 112
          Width = 1231
          Height = 27
          Align = alBottom
          BevelOuter = bvNone
          TabOrder = 0
          object pquanti: TPanel
            Left = 0
            Top = 0
            Width = 130
            Height = 27
            Align = alLeft
            Alignment = taRightJustify
            BevelInner = bvLowered
            BorderWidth = 2
            Font.Charset = EASTEUROPE_CHARSET
            Font.Color = clNavy
            Font.Height = -12
            Font.Name = 'Tahoma'
            Font.Style = [fsBold]
            ParentFont = False
            TabOrder = 0
          end
          object pvalor: TPanel
            Left = 130
            Top = 0
            Width = 130
            Height = 27
            Align = alLeft
            Alignment = taRightJustify
            BevelInner = bvLowered
            BorderWidth = 2
            Font.Charset = EASTEUROPE_CHARSET
            Font.Color = clNavy
            Font.Height = -12
            Font.Name = 'Tahoma'
            Font.Style = [fsBold]
            ParentFont = False
            TabOrder = 1
          end
          object pdesconto: TPanel
            Left = 260
            Top = 0
            Width = 130
            Height = 27
            Align = alLeft
            Alignment = taRightJustify
            BevelInner = bvLowered
            BorderWidth = 2
            Font.Charset = EASTEUROPE_CHARSET
            Font.Color = clNavy
            Font.Height = -12
            Font.Name = 'Tahoma'
            Font.Style = [fsBold]
            ParentFont = False
            TabOrder = 2
          end
          object ptotal: TPanel
            Left = 650
            Top = 0
            Width = 130
            Height = 27
            Align = alLeft
            Alignment = taRightJustify
            BevelInner = bvLowered
            BorderWidth = 2
            Font.Charset = EASTEUROPE_CHARSET
            Font.Color = clNavy
            Font.Height = -12
            Font.Name = 'Tahoma'
            Font.Style = [fsBold]
            ParentFont = False
            TabOrder = 3
            Visible = False
          end
          object pgeral: TPanel
            Left = 780
            Top = 0
            Width = 188
            Height = 27
            Align = alLeft
            Alignment = taRightJustify
            BevelInner = bvLowered
            BorderWidth = 2
            Font.Charset = EASTEUROPE_CHARSET
            Font.Color = clNavy
            Font.Height = -12
            Font.Name = 'Tahoma'
            Font.Style = [fsBold]
            ParentFont = False
            TabOrder = 4
          end
          object pEntrega: TPanel
            Left = 390
            Top = 0
            Width = 130
            Height = 27
            Align = alLeft
            Alignment = taRightJustify
            BevelInner = bvLowered
            BorderWidth = 2
            Font.Charset = EASTEUROPE_CHARSET
            Font.Color = clNavy
            Font.Height = -12
            Font.Name = 'Tahoma'
            Font.Style = [fsBold]
            ParentFont = False
            TabOrder = 5
          end
          object poutras: TPanel
            Left = 520
            Top = 0
            Width = 130
            Height = 27
            Align = alLeft
            Alignment = taRightJustify
            BevelInner = bvLowered
            BorderWidth = 2
            Font.Charset = EASTEUROPE_CHARSET
            Font.Color = clNavy
            Font.Height = -12
            Font.Name = 'Tahoma'
            Font.Style = [fsBold]
            ParentFont = False
            TabOrder = 6
          end
        end
        object listaitm: TDBGrid
          Left = 0
          Top = 0
          Width = 856
          Height = 112
          Align = alClient
          BorderStyle = bsNone
          Color = clCream
          DataSource = Ditm
          DrawingStyle = gdsGradient
          Options = [dgTitles, dgIndicator, dgColumnResize, dgColLines, dgRowLines, dgTabs, dgRowSelect, dgConfirmDelete, dgCancelOnExit, dgTitleClick, dgTitleHotTrack]
          PopupMenu = MenuManutencao
          TabOrder = 1
          TitleFont.Charset = DEFAULT_CHARSET
          TitleFont.Color = clWindowText
          TitleFont.Height = -11
          TitleFont.Name = 'Tahoma'
          TitleFont.Style = []
          OnDrawColumnCell = listaitmDrawColumnCell
          OnKeyDown = listaitmKeyDown
          Columns = <
            item
              Expanded = False
              FieldName = 'itmchave'
              Width = 55
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmitem'
              Width = 30
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'proncm'
              Width = 65
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'procodigo'
              Width = 50
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'pronome'
              Width = 345
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'unisimbolo'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmvalor'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmquantidade'
              Width = 60
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmdesconto'
              Width = 50
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmoutras'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmliquido'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'cfocfop'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmaliqipi'
              Width = 30
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmpis'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmcofins'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmipi'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmicm'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmicms'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmfrete'
              Visible = True
            end>
        end
        object pdetalhe: TPanel
          Left = 856
          Top = 0
          Width = 375
          Height = 112
          Align = alRight
          BevelOuter = bvNone
          BorderWidth = 2
          TabOrder = 2
          object Panel3: TPanel
            Left = 2
            Top = 2
            Width = 371
            Height = 20
            Align = alTop
            Alignment = taLeftJustify
            BevelOuter = bvLowered
            Caption = '          Finaliza'#231#227'o Financeira da Venda'
            Color = 4210816
            Font.Charset = DEFAULT_CHARSET
            Font.Color = clYellow
            Font.Height = -12
            Font.Name = 'MS Sans Serif'
            Font.Style = [fsBold]
            ParentBackground = False
            ParentFont = False
            TabOrder = 0
          end
          object listapor: TDBGrid
            Left = 2
            Top = 42
            Width = 371
            Height = 68
            Align = alClient
            Color = 13303780
            DataSource = DSTotaisDtls
            DrawingStyle = gdsGradient
            Options = [dgTitles, dgColumnResize, dgColLines, dgRowLines, dgRowSelect, dgAlwaysShowSelection, dgConfirmDelete, dgCancelOnExit]
            TabOrder = 1
            TitleFont.Charset = DEFAULT_CHARSET
            TitleFont.Color = clWindowText
            TitleFont.Height = -11
            TitleFont.Name = 'Tahoma'
            TitleFont.Style = []
            OnDblClick = listaporDblClick
            Columns = <
              item
                Expanded = False
                FieldName = 'ltechave'
                Visible = True
              end
              item
                Expanded = False
                FieldName = 'mdaidentificacao'
                Width = 70
                Visible = True
              end
              item
                Expanded = False
                FieldName = 'dtlvalor'
                Width = 70
                Visible = True
              end
              item
                Expanded = False
                FieldName = 'dtlchave'
                Visible = True
              end
              item
                Expanded = False
                FieldName = 'rdcnrauto'
                Width = 60
                Visible = True
              end>
          end
          object pvalordetalhe: TPanel
            Left = 2
            Top = 22
            Width = 371
            Height = 20
            Align = alTop
            Alignment = taRightJustify
            BevelOuter = bvLowered
            BorderWidth = 2
            Caption = 'Dinheiro R$ 0,00'
            Font.Charset = DEFAULT_CHARSET
            Font.Color = clWindowText
            Font.Height = -15
            Font.Name = 'MS Sans Serif'
            Font.Style = [fsBold]
            ParentFont = False
            TabOrder = 2
            Visible = False
          end
        end
      end
      inherited PlFiltros: TPanel
        Width = 1231
        ExplicitWidth = 1231
        inherited PlEdTextoBusca: TPanel
          inherited GrBTextoProcurar: TGroupBox
            inherited PlGbEdtBusca: TPanel
              inherited edbusca: TEdit
                Color = 11206655
              end
            end
          end
        end
        inherited PlBotaoFiltroEsp2: TPanel
          Enabled = True
          Visible = True
        end
      end
      inherited PlSelecao: TPanel
        Width = 1231
        ExplicitWidth = 1231
        inherited GBPlSelecao: TGroupBox
          Width = 1227
          ExplicitWidth = 1227
          inherited DBLista: TDBGrid
            Width = 1120
          end
        end
      end
      inherited PnlGrid: TPanel
        Width = 1231
        Height = 307
        ExplicitWidth = 1231
        ExplicitHeight = 307
        inherited DBGLista: TDBGrid
          Width = 1231
          Height = 281
          Columns = <
            item
              Expanded = False
              FieldName = 'meschave'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesregistro'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesemissao'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'temcodigo'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'temidentificacao'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'toeidentificacao'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'ttecodigo'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'tteidentificacao'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'tdfidentificacao'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'sdecodigo'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'sdeidentificacao'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'messerie'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesnumero'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'etdcodigo'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'etdidentificacao'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesvalor'
              Visible = False
            end
            item
              Expanded = False
              FieldName = 'mesdesconto'
              Visible = False
            end
            item
              Expanded = False
              FieldName = 'mestotal'
              Title.Caption = 'Total Nota R$'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesprodutos'
              Visible = False
            end
            item
              Expanded = False
              FieldName = 'messervicos'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'clbcodigo'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'trmcodigo'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mespis'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mescofins'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesipi'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesicm'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesicms'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesrefeicao'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesfrete'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'oriidentificacao'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesnumeropedido'
              Visible = True
            end>
        end
        inherited PnlRodapeGrid: TPanel
          Top = 281
          Width = 1231
          Height = 26
          Visible = True
          ExplicitTop = 281
          ExplicitWidth = 1231
          ExplicitHeight = 26
          object Pnl1: TPanel
            Left = 1
            Top = 1
            Width = 1229
            Height = 23
            Align = alTop
            BevelOuter = bvNone
            Color = 5356845
            ParentBackground = False
            TabOrder = 0
            object Pltotalsaidas: TPanel
              Left = 0
              Top = 0
              Width = 170
              Height = 23
              Align = alLeft
              Alignment = taRightJustify
              BevelInner = bvLowered
              BevelOuter = bvNone
              BorderWidth = 2
              Caption = 'Sa'#237'das'
              Color = 5356845
              Font.Charset = EASTEUROPE_CHARSET
              Font.Color = clWhite
              Font.Height = -12
              Font.Name = 'Tahoma'
              Font.Style = [fsBold]
              ParentBackground = False
              ParentFont = False
              TabOrder = 0
              Visible = False
            end
            object Pltotaldescontossaidas: TPanel
              Left = 170
              Top = 0
              Width = 152
              Height = 23
              Align = alLeft
              Alignment = taRightJustify
              BevelInner = bvLowered
              BevelOuter = bvNone
              BorderWidth = 2
              Caption = 'Descontos'
              Color = 5356845
              Font.Charset = EASTEUROPE_CHARSET
              Font.Color = clWhite
              Font.Height = -12
              Font.Name = 'Tahoma'
              Font.Style = [fsBold]
              ParentBackground = False
              ParentFont = False
              TabOrder = 1
              Visible = False
            end
            object PltotalPendente: TPanel
              Left = 322
              Top = 0
              Width = 170
              Height = 23
              Align = alLeft
              Alignment = taRightJustify
              BevelInner = bvLowered
              BevelOuter = bvNone
              BorderWidth = 2
              Caption = 'NFE Pendente'
              Color = 5356845
              Font.Charset = EASTEUROPE_CHARSET
              Font.Color = clWhite
              Font.Height = -12
              Font.Name = 'Tahoma'
              Font.Style = [fsBold]
              ParentBackground = False
              ParentFont = False
              TabOrder = 2
              Visible = False
            end
            object Pltotalnfesaidas: TPanel
              Left = 492
              Top = 0
              Width = 170
              Height = 23
              Align = alLeft
              Alignment = taRightJustify
              BevelInner = bvLowered
              BevelOuter = bvNone
              BorderWidth = 2
              Caption = 'NFE Emitidas'
              Color = 5356845
              Font.Charset = EASTEUROPE_CHARSET
              Font.Color = clWhite
              Font.Height = -12
              Font.Name = 'Tahoma'
              Font.Style = [fsBold]
              ParentBackground = False
              ParentFont = False
              TabOrder = 3
            end
          end
        end
      end
    end
    inherited PlTitulo: TPanel
      Width = 1375
      ExplicitWidth = 1375
      inherited plid: TPanel
        Left = 925
        ExplicitLeft = 925
      end
      inherited PlSair: TPanel
        Left = 1169
        ExplicitLeft = 1169
      end
    end
  end
  inherited acoes: TActionList
    Left = 732
    Top = 180
    object ActImprimirVendaNFCE: TAction [0]
      Category = 'NFCEs'
      Caption = 'Gerar NFCe'
      OnExecute = ActImprimirVendaNFCEExecute
    end
    object ActReenviar: TAction [1]
      Category = 'NFCEs'
      Caption = 'Reenviar NFCe'
    end
    object ActGerarNova: TAction [2]
      Category = 'NFCEs'
      Caption = 'Gerar Nova NFCe'
      Enabled = False
      Visible = False
      OnExecute = ActGerarNovaExecute
    end
    object ActGerarNovaVenda: TAction [3]
      Category = 'NFCEs'
      Caption = 'Gerar Nova Venda'
      Enabled = False
      Visible = False
      OnExecute = ActGerarNovaVendaExecute
    end
    object ActAjustarEntidadeNFCE: TAction [4]
      Category = 'NFCEs - Ajustar'
      Caption = 'Cliente Completo'
      OnExecute = ActAjustarEntidadeNFCEExecute
    end
    object ActVeriricarPendentes: TAction [5]
      Category = 'NFCEs'
      Caption = 'Verificar Pendentes'
      OnExecute = ActVeriricarPendentesExecute
    end
    object ActVerificarStatus: TAction [6]
      Category = 'NFCEs'
      Caption = 'Verificar Status'
      OnExecute = ActVerificarStatusExecute
    end
    object ActAjustarEntidadeSimplesNFCE: TAction [7]
      Category = 'NFCEs - Ajustar'
      Caption = 'Cliente Simplificado'
      OnExecute = ActAjustarEntidadeSimplesNFCEExecute
    end
    object ActReimprimirNFCE: TAction
      Category = 'NFCEs'
      Caption = 'Reimprimir NFCe'
      OnExecute = ActReimprimirNFCEExecute
    end
    object ActVisualizarNFCE: TAction
      Category = 'NFCEs'
      Caption = 'Visualizar NFCE'
      OnExecute = ActVisualizarNFCEExecute
    end
    object ActRenviaremail: TAction
      Category = 'NFCEs'
      Caption = 'Enviar email da NFCe'
      OnExecute = ActRenviaremailExecute
    end
    object ActInutilizar: TAction
      Category = 'NFCEs'
      Caption = 'Inutilizar Numera'#231#227'o'
      OnExecute = ActInutilizarExecute
    end
    object ActSelecionarChaveNFE: TAction
      Category = 'NFCEs'
      Caption = 'Copiar Chave NFCe'
      OnExecute = ActSelecionarChaveNFEExecute
    end
    object ActConsultaStatusSEFAZ: TAction
      Category = 'NFCEs - Consulta'
      Caption = 'Status SEFAZ'
      OnExecute = ActConsultaStatusSEFAZExecute
    end
    object ActConsultaStatusAjustarNFCESEFAZMT: TAction
      Category = 'NFCEs - Consulta'
      Caption = 'NFCE - Consulta'
      OnExecute = ActConsultaStatusAjustarNFCESEFAZMTExecute
    end
    object ActCancelarNFCE: TAction
      Category = 'NFCEs - Eventos'
      Caption = 'Cancelar NFCE'
      OnExecute = ActCancelarNFCEExecute
    end
    object ActConsolidarSEFAZ: TAction
      Category = 'NFCEs - Consulta'
      Caption = 'Consolidar com SEFAZ'
    end
    object ActGerarXML: TAction
      Category = 'NFCEs'
      Caption = 'Regerar XML'
      Enabled = False
      Visible = False
      OnExecute = ActGerarXMLExecute
    end
    object ActGerarXMLCont: TAction
      Category = 'NFCEs'
      Caption = 'Regerar XML Cont'
      Enabled = False
      Visible = False
      OnExecute = ActGerarXMLContExecute
    end
    object ActSalvarXMLS: TAction
      Category = 'NFCEs'
      Caption = 'Salvar XMLS'
      Enabled = False
      Visible = False
      OnExecute = ActSalvarXMLSExecute
    end
    object ActReGerarXML: TAction
      Category = 'NFCEs'
      Caption = 'ReGerar XMLs'
      Enabled = False
      Visible = False
      OnExecute = ActReGerarXMLExecute
    end
  end
  inherited MenuManutencao: TPopupMenu
    object mnUtilitarios: TMenuItem [8]
      Caption = 'Utilit'#225'rios'
      object RegerarXMLTODASdetodasemContigencia1: TMenuItem
        Caption = 'Regerar XML TODAS de todas em Contigencia'
        Visible = False
        OnClick = RegerarXMLTODASdetodasemContigencia1Click
      end
      object ConultasTODASasnotas1: TMenuItem
        Caption = 'Consultar TODAS as notas'
        Visible = False
        OnClick = ConultasTODASasnotas1Click
      end
      object GerarTODASasPendentes1: TMenuItem
        Caption = 'Gerar TODAS as Pendentes'
        Visible = False
        OnClick = GerarTODASasPendentes1Click
      end
      object RegerarXMLtodas1: TMenuItem
        Caption = 'Regerar XML todas'
        Visible = False
        OnClick = RegerarXMLtodas1Click
      end
      object N1: TMenuItem
        Caption = '-'
        Visible = False
      end
      object GerarNotasCartesePIX1: TMenuItem
        Caption = 'Gerar Notas Cart'#245'es e PIX'
        OnClick = GerarNotasCartesePIX1Click
      end
      object RegerarXMLs1: TMenuItem
        Caption = 'Regerar XMLs'
        OnClick = RegerarXMLs1Click
      end
      object RecuperarModalidade1: TMenuItem
        Caption = 'Recuperar Modalidade'
        OnClick = RecuperarModalidade1Click
      end
    end
    object Removerduplicidade1: TMenuItem [9]
      Caption = 'Remover duplicidade'
      OnClick = Removerduplicidade1Click
    end
  end
  inherited uqtabela: TUniQuery
    SQL.Strings = (
      'SELECT'
      '  mes.meschave,'
      '  IF((SELECT'
      '      COUNT(micchave)'
      '    FROM mic'
      
        '    WHERE mic.meschave = mes.meschave LIMIT 1) > 0, CONCAT(etd.e' +
        'tdidentificacao, '#39' '#39', (SELECT'
      '      idcnome'
      '    FROM idc,'
      '         mic'
      '    WHERE idc.idccodigo = mic.idccodigo'
      
        '    AND mic.meschave = mes.meschave LIMIT 1  ) ) , etd.etdidenti' +
        'ficacao) AS etdidentificacao,'
      '  sde.sdeidentificacao,'
      '  tdf.tdfidentificacao,'
      '  toe.toeidentificacao,'
      '  mes.mesemissao,'
      '  mes.mesnumero,'
      '  mes.etdcodigo,'
      '  mes.messerie,'
      '  meschavenfe,'
      '  mes.mesregistro,'
      '  mes.mesvalor,'
      '  mes.mesdesconto,'
      '--  mes.mestotal   ,'
      
        '  mes.mestotal-IFNULL((SELECT SUM(itmtotal-itmdesconto+itmoutras' +
        ') FROM itm, pro,grp WHERE itm.meschave=mes.meschave and itm.proc' +
        'odigo=pro.procodigo AND pro.grpcodigo=grp.grpcodigo AND grp.grpi' +
        'dentificacao='#39'TAXAS ESPECIAIS'#39'),0) mestotal,'
      '  mes.temcodigo,'
      '  mes.clbcodigo,'
      '  mes.trmcodigo,'
      '  mesprotocolo,'
      '  mes.sdecodigo,'
      '  mesdatanfe,'
      '  toeorigem,'
      '  mes.tdfcodigo,'
      '  toe.ttecodigo,'
      '  tte.tteidentificacao,'
      '  temidentificacao,'
      '  mesprodutos,'
      '  messervicos,'
      '  toe.ttocodigo,'
      '  mes.mespis,'
      '  mes.mescofins,'
      '  mes.mesipi,'
      '  mes.mesicm,'
      '  mes.mesicms,'
      '  mes.flacodigo,'
      '  mes.mescodigonota,'
      '  mes.mesrefeicao,'
      '  ori.oriidentificacao,'
      '  mes.mesfrete,'
      '  mes.oricodigo,'
      '  mes.mesnumeropedido'
      ''
      ''
      'FROM mes,'
      '     etd,'
      '     sde,'
      '     tdf,'
      '     toe,'
      '     tte,'
      '     tem,'
      '     ori'
      'WHERE etd.etdcodigo = mes.etdcodigo'
      'AND mes.temcodigo = tem.temcodigo'
      'AND mes.oricodigo = ori.oricodigo'
      'AND sde.sdecodigo = mes.sdecodigo'
      'AND tte.ttecodigo = toe.ttecodigo'
      'AND tdf.tdfcodigo = mes.tdfcodigo'
      'AND toe.toecodigo = mes.toecodigo'
      'AND toe.ttmcodigo = 0'
      'AND toe.ttecodigo = 1'
      'AND mes.tdfcodigo NOT IN ('#39'01'#39', '#39'2D'#39', '#39'AF'#39', '#39'RF'#39', '#39'CE'#39', '#39'55'#39')'
      
        'AND IF(mes.sdecodigo = '#39'02'#39', NOT mes.tdfcodigo = '#39'00'#39', toe.ttmco' +
        'digo = 0)'
      ''
      ''
      ''
      '')
    object uqtabelameschave: TIntegerField
      AutoGenerateValue = arAutoInc
      DisplayLabel = 'Nr. Chave'
      FieldName = 'meschave'
    end
    object uqtabelamesemissao: TDateField
      DisplayLabel = 'Emiss'#227'o'
      FieldName = 'mesemissao'
      EditMask = '!99/99/0000;1;_'
    end
    object uqtabelatdfidentificacao: TStringField
      DisplayLabel = 'Tipo Documento'
      FieldName = 'tdfidentificacao'
      Size = 50
    end
    object uqtabelamesnumero: TIntegerField
      DisplayLabel = 'Nr. Documento'
      FieldName = 'mesnumero'
    end
    object uqtabelaetdcodigo: TIntegerField
      DisplayLabel = 'C'#243'digo'
      FieldName = 'etdcodigo'
    end
    object uqtabelaetdidentificacao: TStringField
      DisplayLabel = 'Cliente'
      FieldName = 'etdidentificacao'
      Size = 50
    end
    object uqtabelamesvalor: TFloatField
      DisplayLabel = 'Total R$'
      FieldName = 'mesvalor'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelamesdesconto: TFloatField
      DisplayLabel = 'Desconto R$'
      FieldName = 'mesdesconto'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelamestotal: TFloatField
      DisplayLabel = 'Total L'#237'quido R$'
      FieldName = 'mestotal'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelasdeidentificacao: TStringField
      DisplayLabel = 'Situa'#231#227'o Documento'
      FieldName = 'sdeidentificacao'
      Required = True
      Size = 50
    end
    object uqtabelatoeidentificacao: TStringField
      DisplayLabel = 'Destina'#231#227'o'
      FieldName = 'toeidentificacao'
      Required = True
      Size = 50
    end
    object uqtabelamesserie: TStringField
      DisplayLabel = 'S'#233'rie'
      FieldName = 'messerie'
      Size = 5
    end
    object uqtabelaclbcodigo: TIntegerField
      DisplayLabel = 'Clb'
      FieldName = 'clbcodigo'
      Required = True
    end
    object uqtabelatrmcodigo: TIntegerField
      DisplayLabel = 'Trm'
      FieldName = 'trmcodigo'
      Required = True
    end
    object uqtabelamesprotocolo: TStringField
      FieldName = 'mesprotocolo'
      Size = 50
    end
    object uqtabelasdecodigo: TStringField
      DisplayLabel = 'C'#243'd. Situa'#231#227'o'
      FieldName = 'sdecodigo'
      Size = 2
    end
    object uqtabelamesdatanfe: TDateField
      DisplayLabel = 'Data NFE'
      FieldName = 'mesdatanfe'
    end
    object uqtabelatemcodigo: TIntegerField
      DisplayLabel = 'Cod. Est'#225'gio'
      FieldName = 'temcodigo'
    end
    object uqtabelatemidentificacao: TStringField
      DisplayLabel = 'Est'#225'gio'
      FieldName = 'temidentificacao'
    end
    object uqtabelatoeorigem: TStringField
      FieldName = 'toeorigem'
      Size = 1
    end
    object uqtabelatdfcodigo: TStringField
      FieldName = 'tdfcodigo'
      Size = 2
    end
    object uqtabelattecodigo: TIntegerField
      DisplayLabel = 'Cod. Tipo Mov.'
      FieldName = 'ttecodigo'
    end
    object uqtabelatteidentificacao: TStringField
      Tag = 999
      DisplayLabel = 'Tipo Mov.'
      FieldName = 'tteidentificacao'
      Size = 35
    end
    object uqtabelameschavenfe: TStringField
      FieldName = 'meschavenfe'
      Size = 100
    end
    object uqtabelamesregistro: TDateField
      DisplayLabel = 'Registro'
      FieldName = 'mesregistro'
    end
    object uqtabelamesprodutos: TFloatField
      DisplayLabel = 'Produtos R$'
      FieldName = 'mesprodutos'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelamesservicos: TFloatField
      DisplayLabel = 'Servi'#231'os R$'
      FieldName = 'messervicos'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelattocodigo: TIntegerField
      FieldName = 'ttocodigo'
    end
    object uqtabelamespis: TFloatField
      DisplayLabel = 'PIS'
      FieldName = 'mespis'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelamescofins: TFloatField
      DisplayLabel = 'Cofins'
      FieldName = 'mescofins'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelamesipi: TFloatField
      DisplayLabel = 'IPI'
      FieldName = 'mesipi'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelamesicm: TFloatField
      DisplayLabel = 'ICM'
      FieldName = 'mesicm'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelamesicms: TFloatField
      DisplayLabel = 'ICM-Subst.'
      FieldName = 'mesicms'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelaflacodigo: TIntegerField
      FieldName = 'flacodigo'
    end
    object uqtabelamescodigonota: TIntegerField
      FieldName = 'mescodigonota'
    end
    object uqtabelamesrefeicao: TIntegerField
      DisplayLabel = 'Refei'#231#227'o'
      FieldName = 'mesrefeicao'
    end
    object uqtabelamesfrete: TCurrencyField
      DisplayLabel = 'Entrega'
      FieldName = 'mesfrete'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelaoriidentificacao: TStringField
      DisplayLabel = 'Origem'
      FieldName = 'oriidentificacao'
      Size = 30
    end
    object uqtabelaoricodigo: TIntegerField
      FieldName = 'oricodigo'
    end
    object uqtabelamesnumeropedido: TStringField
      DisplayLabel = 'Nr.Pedido'
      FieldName = 'mesnumeropedido'
    end
  end
  inherited cpg: TUniQuery
    Left = 460
    Top = 344
  end
  inherited vcls: TVirtualTable
    Data = {04000000000000000000}
  end
  inherited cpc: TUniQuery
    Left = 389
    Top = 361
  end
  inherited Dsfi: TUniDataSource
    Top = 332
  end
  inherited sfi: TUniQuery
    Left = 308
    Top = 336
  end
  inherited lou: TUniQuery
    Left = 552
    Top = 336
  end
  inherited ColorDialog: TColorDialog
    Left = 976
    Top = 341
  end
  inherited ImageList1: TImageList
    Left = 664
    Top = 333
  end
  inherited XMLDocument1: TXMLDocument
    Left = 800
    Top = 189
  end
  object cfg: TUniQuery
    SQL.Strings = (
      'SELECT'
      '  /*Principal*/'
      '  cfgmcfg.cfgcodigo,'
      '  cfgmcfg.cfgetdempresa,'
      ''
      '  /*Entradas*/'
      '  cfgment.cfgprouso,'
      '  cfgment.cfgtoeusofora,'
      '  cfgment.cfgtoeusointe,'
      ''
      '  /*Sa'#237'das*/'
      '  cfgmsai.cfgtoecuffora,'
      '  cfgmsai.cfgtoecufinte,'
      ''
      '  /*Contas a Receber*/'
      '  cfgmcre.cfgviaassinar,'
      ''
      '  /*Emiss'#227'o NFe*/'
      '  cfgmnfe.cfgviasnfe,'
      '  cfgmnfe.cfgnumeronfe,'
      '  cfgmnfe.cfgserienfe,'
      '  cfgmnfe.cfgnumeronfce,'
      '  cfgmnfe.cfgserienfce,'
      '  cfgmnfe.cfgobs1,'
      '  cfgmnfe.cfgobs2,'
      '  cfgmnfe.cfgobs3,'
      '  cfgmnfe.cfgobs4,'
      '  cfgmnfe.cfgdescrinfe,'
      '  cfgmnfe.cfgnumecertif,'
      '  cfgmnfe.cfgnumecertifa1,'
      '  cfgmnfe.cfgsenhacertificadoa1,'
      '  cfgmnfe.cfgtoken1nfce,'
      '  cfgmnfe.cfgidtokennfce,'
      '  cfgmnfe.cfgmodonfe,'
      ''
      ''
      '  /*Email*/'
      '  cfgmnfe.cfgemailnfe,'
      '  cfgmnfe.cfgemailservidornfe,'
      '  cfgmnfe.cfgemailsenhanfe,'
      '  cfgmnfe.cfgmailportnfe,'
      '  cfgmnfe.cfgemailusatls,'
      '  cfgmsai.cfgmensagempdv,'
      ''
      '  /*SPED*/'
      '  cfgmcfg.crtcodigo,'
      '  cfgmspd.cfgcstterceiros,'
      ''
      '  /*Dados da Empresa*/'
      '  etd.etdapelido,'
      '  etd.etdidentificacao,'
      '  etd.etddoc1,'
      ''
      '  edr.ufscodigo,'
      '  edr.cddcodigo,'
      '  edr.edrinscest,'
      '  edr.edrrua,'
      '  edr.edrnumero,'
      '  edr.edrbairro,'
      '  edr.edrcep,'
      '  cdd.cddnome,'
      '  ufs.ufssigla,'
      ''
      '  etf.etftelefone,'
      '  '
      '  /*Box-e - Dom'#237'nio Sistemas*/'
      '  ctd.ctdboxedominio,'
      '  cfgmensagempdv,'
      '  cfgtrmimpfis1,'
      '  cfgtrmimpfis2,'
      '  cfgtrmtef1,'
      '  cfgtrmtef2,'
      '  cfgimpnfe1,'
      '  cfgimpnfe2,'
      '  cfgimpnfc1,'
      '  cfgimpnfc2,'
      '  cfgimpnfc3,'
      '  cfgservarqnfes,'
      '  cfg.cfgusanfc'
      'FROM cfgmcfg,'
      '     ufs,'
      '     etd,'
      '     cfgmnfe,'
      '     cfgment,'
      '     cfgmcre,'
      '     edr,'
      '     cfg,'
      '     cfgmspd,'
      '     etf,'
      '     cdd,'
      '     cfgmsai,'
      '     ctd'
      'WHERE cfg.cfgcodigo = ctd.cfgcodigo'
      'AND cfg.cfgcodigo = cfgmsai.cfgcodigo'
      'AND ufs.ufscodigo = edr.ufscodigo'
      'AND cfg.cfgcodigo = cfgmcfg.cfgcodigo'
      'AND cfg.cfgcodigo = cfgmcre.cfgcodigo'
      'AND etd.etdcodigo = etf.etdcodigo'
      'AND etf.ttfcodigo = 1'
      'AND edr.cddcodigo = cdd.cddcodigo'
      'AND cfg.cfgcodigo = cfgment.cfgcodigo'
      'AND cfg.cfgcodigo = cfgmnfe.cfgcodigo'
      'AND etd.etdcodigo = cfgmcfg.cfgetdempresa'
      'AND etd.etdcodigo = edr.etdcodigo'
      'AND edr.tedcodigo = 1'
      'AND cfg.cfgcodigo = cfgmspd.cfgcodigo'
      'AND cfg.flacodigo = :flacodigo')
    Left = 866
    Top = 228
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'flacodigo'
        Value = nil
      end>
    object cfgcfgcodigo: TIntegerField
      FieldName = 'cfgcodigo'
      Required = True
    end
    object cfgcfgservarqnfes: TStringField
      FieldName = 'cfgservarqnfes'
      Size = 100
    end
    object cfgcfgnumecertif: TStringField
      FieldName = 'cfgnumecertif'
      Size = 100
    end
    object cfgcfgetdempresa: TIntegerField
      FieldName = 'cfgetdempresa'
    end
    object cfgcfgviasnfe: TIntegerField
      FieldName = 'cfgviasnfe'
      Required = True
    end
    object cfgcfgserienfe: TStringField
      FieldName = 'cfgserienfe'
      Size = 5
    end
    object cfgcfgserienfce: TStringField
      FieldName = 'cfgserienfce'
      Size = 5
    end
    object cfgcfgdescrinfe: TIntegerField
      FieldName = 'cfgdescrinfe'
      Required = True
    end
    object cfgcfgemailnfe: TStringField
      FieldName = 'cfgemailnfe'
      Size = 50
    end
    object cfgcfgemailservidornfe: TStringField
      FieldName = 'cfgemailservidornfe'
      Size = 50
    end
    object cfgcfgemailsenhanfe: TStringField
      FieldName = 'cfgemailsenhanfe'
      Size = 50
    end
    object cfgcfgmailportnfe: TStringField
      FieldName = 'cfgmailportnfe'
      Required = True
      Size = 5
    end
    object cfgcfgemailusatls: TIntegerField
      FieldName = 'cfgemailusatls'
      Required = True
    end
    object cfgcrtcodigo: TIntegerField
      FieldName = 'crtcodigo'
      Required = True
    end
    object cfgetdapelido: TStringField
      FieldName = 'etdapelido'
      Size = 100
    end
    object cfgetdidentificacao: TStringField
      FieldName = 'etdidentificacao'
      Required = True
      Size = 50
    end
    object cfgetddoc1: TStringField
      FieldName = 'etddoc1'
    end
    object cfgufscodigo: TStringField
      FieldName = 'ufscodigo'
      Required = True
      Size = 10
    end
    object cfgcddcodigo: TStringField
      FieldName = 'cddcodigo'
      Required = True
      Size = 10
    end
    object cfgedrinscest: TStringField
      FieldName = 'edrinscest'
      Required = True
    end
    object cfgedrrua: TStringField
      FieldName = 'edrrua'
      Required = True
      Size = 50
    end
    object cfgedrnumero: TStringField
      FieldName = 'edrnumero'
      Required = True
      Size = 10
    end
    object cfgedrbairro: TStringField
      FieldName = 'edrbairro'
      Required = True
      Size = 60
    end
    object cfgedrcep: TStringField
      FieldName = 'edrcep'
      Required = True
      Size = 10
    end
    object cfgcddnome: TStringField
      FieldName = 'cddnome'
      Required = True
      Size = 50
    end
    object cfgufssigla: TStringField
      FieldName = 'ufssigla'
      Required = True
      Size = 3
    end
    object cfgetftelefone: TStringField
      FieldName = 'etftelefone'
      Required = True
    end
    object cfgcfgusanfc: TIntegerField
      FieldName = 'cfgusanfc'
    end
    object cfgcfgtoken1nfce: TStringField
      FieldName = 'cfgtoken1nfce'
      Size = 100
    end
    object cfgcfgnumecertifa1: TStringField
      FieldName = 'cfgnumecertifa1'
      Size = 100
    end
    object cfgcfgmodonfe: TIntegerField
      FieldName = 'cfgmodonfe'
    end
    object cfgcfgsenhacertificadoa1: TStringField
      FieldName = 'cfgsenhacertificadoa1'
      Size = 50
    end
    object cfgcfgidtokennfce: TStringField
      FieldName = 'cfgidtokennfce'
      Size = 6
    end
    object cfgcfgviaassinar: TIntegerField
      FieldName = 'cfgviaassinar'
    end
    object cfgcfgmensagempdv: TStringField
      FieldName = 'cfgmensagempdv'
      Size = 250
    end
  end
  object itm: TUniQuery
    SQL.Strings = (
      'SELECT'
      '  pro.pronome,'
      '  itm.itmchave,'
      '  itm.meschave,'
      '  itm.itmitem,'
      '  itm.procodigo,'
      '  pro.proncm,'
      '  uni.unisimbolo,'
      '  itm.itmquantidade,'
      '  itm.itmvalor,'
      '  itm.itmdesconto,'
      '  itm.itmtotal,'
      '  itm.itmoutras,'
      '  itm.cfocfop,'
      '  itm.itmaliqipi,'
      '  (itm.itmtotal-itm.itmdesconto+itmoutras) as  itmliquido,'
      '  itm.itmpis,'
      '  itm.itmcofins,'
      '  itm.itmipi,'
      '  itm.itmicm,'
      '  itm.itmicms,'
      '  itm.itmacrescimoav,  '
      '  itm.itmfrete'
      ''
      ''
      ''
      ''
      'FROM itm,'
      '     pro,'
      '     grp,'
      '     pun,'
      '     uni'
      'WHERE pro.procodigo = itm.procodigo'
      'AND itm.puncodigo = pun.puncodigo'
      'AND uni.unicodigo = pun.unicodigo'
      'AND pro.grpcodigo = grp.grpcodigo'
      'and grp.grpidentificacao<>'#39'TAXAS ESPECIAIS'#39
      'AND itm.meschave = :meschave'
      'ORDER BY itm.itmitem')
    Left = 740
    Top = 472
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'meschave'
        Value = nil
      end>
    object itmitmchave: TIntegerField
      AutoGenerateValue = arAutoInc
      DisplayLabel = 'Nr. Chave'
      FieldName = 'itmchave'
      ReadOnly = True
    end
    object itmmeschave: TIntegerField
      FieldName = 'meschave'
      ReadOnly = True
      Required = True
    end
    object itmitmitem: TIntegerField
      DisplayLabel = 'Item'
      FieldName = 'itmitem'
      ReadOnly = True
      Required = True
    end
    object itmprocodigo: TIntegerField
      DisplayLabel = 'Produto'
      FieldName = 'procodigo'
      ReadOnly = True
      Required = True
    end
    object itmpronome: TStringField
      DisplayLabel = 'Identifica'#231#227'o do Produto / Servi'#231'o'
      FieldName = 'pronome'
      Required = True
      Size = 150
    end
    object itmunisimbolo: TStringField
      DisplayLabel = 'UN'
      FieldName = 'unisimbolo'
      ReadOnly = True
      Required = True
      FixedChar = True
      Size = 6
    end
    object itmitmvalor: TFloatField
      DisplayLabel = 'Vlr Unit R$'
      FieldName = 'itmvalor'
      ReadOnly = True
      Required = True
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object itmitmquantidade: TFloatField
      DisplayLabel = 'Quant.'
      FieldName = 'itmquantidade'
      ReadOnly = True
      Required = True
      DisplayFormat = '#,###0.000'
      EditFormat = '#,###0.000'
    end
    object itmitmdesconto: TFloatField
      DisplayLabel = 'Desc. R$'
      FieldName = 'itmdesconto'
      ReadOnly = True
      Required = True
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object itmitmtotal: TFloatField
      DisplayLabel = 'Total Item R$'
      FieldName = 'itmtotal'
      ReadOnly = True
      Required = True
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object itmcfocfop: TStringField
      DisplayLabel = 'CFOP'
      FieldName = 'cfocfop'
      ReadOnly = True
      Required = True
      Size = 5
    end
    object itmitmpis: TFloatField
      DisplayLabel = 'PIS'
      FieldName = 'itmpis'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object itmitmcofins: TFloatField
      DisplayLabel = 'COFINS'
      FieldName = 'itmcofins'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object itmitmipi: TFloatField
      DisplayLabel = 'IPI'
      FieldName = 'itmipi'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object itmitmicm: TFloatField
      DisplayLabel = 'ICM'
      FieldName = 'itmicm'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object itmitmicms: TFloatField
      DisplayLabel = 'ICMS'
      FieldName = 'itmicms'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object itmitmaliqipi: TFloatField
      DisplayLabel = '% IPI'
      FieldName = 'itmaliqipi'
      DisplayFormat = '#,#0.0'
      EditFormat = '#,#0.0'
    end
    object itmproncm: TStringField
      DisplayLabel = 'NCM'
      FieldName = 'proncm'
      Size = 15
    end
    object itmitmliquido: TFloatField
      DisplayLabel = 'L'#237'quido R$'
      FieldName = 'itmliquido'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object itmitmoutras: TFloatField
      DisplayLabel = 'Outras R$'
      FieldName = 'itmoutras'
      DisplayFormat = '#,#0.00'
      EditFormat = '#,#0.00'
    end
    object itmitmacrescimoav: TFloatField
      FieldName = 'itmacrescimoav'
    end
    object itmitmfrete: TCurrencyField
      DisplayLabel = 'Entrega'
      FieldName = 'itmfrete'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
  end
  object Ditm: TUniDataSource
    DataSet = itm
    Left = 808
    Top = 480
  end
  object mic: TUniQuery
    SQL.Strings = (
      
        'select micchave, idccodigo, meschave from mic where mic.meschave' +
        '=:meschave')
    Left = 824
    Top = 280
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'meschave'
        Value = nil
      end>
    object micmicchave: TIntegerField
      FieldName = 'micchave'
    end
    object micidccodigo: TIntegerField
      FieldName = 'idccodigo'
    end
    object micmeschave: TIntegerField
      FieldName = 'meschave'
    end
  end
  object mes: TUniQuery
    SQL.Strings = (
      'select meschave, etdcodigo from mes where meschave=:meschave')
    Left = 874
    Top = 172
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'meschave'
        Value = nil
      end>
    object mesmeschave: TIntegerField
      FieldName = 'meschave'
    end
    object mesetdcodigo: TIntegerField
      FieldName = 'etdcodigo'
    end
  end
  object mesnova: TUniQuery
    Left = 728
    Top = 349
  end
  object mesatual: TUniQuery
    Left = 680
    Top = 349
  end
  object mesxml: TUniQuery
    SQL.Strings = (
      'SELECT'
      '  meschave,'
      '  mesarqxml'
      'FROM mesxml'
      'where meschave=:meschave')
    Left = 832
    Top = 341
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'meschave'
        Value = nil
      end>
    object mesxmlmeschave: TIntegerField
      FieldName = 'meschave'
    end
    object mesxmlmesarqxml: TBlobField
      FieldName = 'mesarqxml'
    end
  end
  object OpenDialog: TOpenDialog
    Left = 896
    Top = 309
  end
  object TotaisDtls: TVirtualTable
    FieldDefs = <
      item
        Name = 'mdaidentificacao'
        DataType = ftString
        Size = 35
      end
      item
        Name = 'dtlvalor'
        DataType = ftFloat
        Precision = 15
      end
      item
        Name = 'mdacodigo'
        DataType = ftInteger
      end>
    Left = 1128
    Top = 540
    Data = {
      0400030010006D64616964656E74696669636163616F01002300000000000800
      64746C76616C6F72060000000F00000009006D6461636F6469676F0300000000
      000000000000000000}
    object TotaisDtlsmdaidentificacao: TStringField
      DisplayLabel = 'Modalidade'
      FieldName = 'mdaidentificacao'
      Size = 35
    end
    object TotaisDtlsdtlvalor: TFloatField
      DisplayLabel = 'Valor R$'
      FieldName = 'dtlvalor'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object TotaisDtlsmdacodigo: TIntegerField
      FieldName = 'mdacodigo'
    end
    object TotaisDtlsltechave: TIntegerField
      DisplayLabel = 'Lote'
      FieldName = 'ltechave'
    end
    object TotaisDtlsrdcnrauto: TStringField
      DisplayLabel = 'Nr. Autoriza'#231#227'o'
      FieldName = 'rdcnrauto'
      Size = 200
    end
    object TotaisDtlsdtlchave: TIntegerField
      DisplayLabel = 'Detalhe Lte'
      FieldName = 'dtlchave'
    end
  end
  object DSTotaisDtls: TDataSource
    DataSet = TotaisDtls
    Left = 1064
    Top = 543
  end
  object dtl: TUniQuery
    SQL.Strings = (
      ''
      'SELECT DISTINCT'
      ''
      '    mda.mdaidentificacao,'
      
        '  ( dtl.dtlvalor) -IFNULL((SELECT SUM(itmtotal-itmdesconto+itmou' +
        'tras) FROM itm, pro,grp WHERE itm.meschave=mes.meschave and itm.' +
        'procodigo=pro.procodigo AND pro.grpcodigo=grp.grpcodigo AND grp.' +
        'grpidentificacao='#39'TAXAS ESPECIAIS'#39'),0)   dtlvalor,'
      '  dtl.ltechave,'
      '   mda.mdacodigo,'
      '   dtl.rdcnrauto,'
      '   dtl.dtlchave'
      ''
      'FROM rfm'
      '  INNER JOIN mes'
      '    ON rfm.meschave = mes.meschave'
      '    '
      '  INNER JOIN rfi'
      '    ON rfm.rfichave = rfi.rfichave'
      '    '
      '  INNER JOIN mfi'
      '    ON mfi.rfichave = rfi.rfichave'
      ''
      '  LEFT JOIN mlt'
      '    ON mlt.mfichave = mfi.mfichave'
      ''
      '  INNER JOIN dtl'
      '    ON dtl.ltechave = mlt.ltechave'
      ''
      '  INNER JOIN mda'
      '    ON dtl.mdacodigo = mda.mdacodigo'
      '  INNER JOIN lte'
      '    ON mlt.ltechave = lte.ltechave'
      ''
      'WHERE rfi.tfdcodigo IN (2, 32)'
      'AND IF(rfi.tfdcodigo = 2, mfi.tmfcodigo = 2, mfi.tmfcodigo)'
      'AND mes.tdfcodigo <> '#39'RF'#39
      '-- AND mes.mesrefeicao = 0'
      'AND mes.meschave = :meschave'
      'AND mes.flacodigo = :flacodigo'
      ''
      'UNION DISTINCT'
      ''
      ''
      'SELECT DISTINCT'
      ''
      '    mda.mdaidentificacao,'
      
        '  ( dtl.dtlvalor) -IFNULL((SELECT SUM(itmtotal-itmdesconto+itmou' +
        'tras) FROM itm, pro,grp WHERE itm.meschave=mes.meschave and itm.' +
        'procodigo=pro.procodigo AND pro.grpcodigo=grp.grpcodigo AND grp.' +
        'grpidentificacao='#39'TAXAS ESPECIAIS'#39'),0)   dtlvalor,'
      '  dtl.ltechave,'
      '   mda.mdacodigo,'
      '  dtl.rdcnrauto,'
      ' dtl.dtlchave'
      ''
      'FROM rfm'
      '  INNER JOIN mes'
      '    ON rfm.meschave = mes.meschave'
      ''
      '  INNER JOIN rfi'
      '    ON rfm.rfichave = rfi.rfichave'
      ''
      '  INNER JOIN mfi'
      '    ON mfi.rfichave = rfi.rfichave'
      ''
      '  LEFT JOIN mlt'
      '    ON mlt.mfichave = mfi.mfichave'
      ''
      '  INNER JOIN dtl'
      '    ON dtl.ltechave = mlt.ltechave'
      ''
      '  INNER JOIN mda'
      '    ON dtl.mdacodigo = mda.mdacodigo'
      '  INNER JOIN lte'
      '    ON mlt.ltechave = lte.ltechave'
      ''
      'WHERE rfi.tfdcodigo IN ( 2)'
      'AND IF(rfi.tfdcodigo = 2, mfi.tmfcodigo = 2, mfi.tmfcodigo)'
      'AND mes.tdfcodigo <> '#39'RF'#39
      '-- AND mes.mesrefeicao = 0'
      'AND rfi.tficodigo=10'
      'AND mes.meschave = :meschave'
      'AND mes.flacodigo = :flacodigo'
      ''
      '')
    Options.DetailDelay = 50
    Left = 1008
    Top = 528
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'meschave'
        Value = nil
      end
      item
        DataType = ftUnknown
        Name = 'flacodigo'
        Value = nil
      end>
    object dtlltechave: TIntegerField
      FieldName = 'ltechave'
    end
    object dtlmdaidentificacao: TStringField
      FieldName = 'mdaidentificacao'
      Size = 25
    end
    object dtldtlvalor: TFloatField
      FieldName = 'dtlvalor'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object dtlmdacodigo: TIntegerField
      FieldName = 'mdacodigo'
    end
    object dtldtlchave: TIntegerField
      FieldName = 'dtlchave'
    end
    object dtlrdcnrauto: TStringField
      FieldName = 'rdcnrauto'
      Size = 200
    end
  end
  object uqDtlConvenios: TUniQuery
    SQL.Strings = (
      'SELECT'
      '  '#39'Conv'#234'nio'#39' AS mdaidentificacao,'
      '  SUM(rfivalor) AS dtlvalor,'
      '  7 AS mdacodigo,'
      '  '#39#39' rdcnrauto,'
      '  '#39#39' as dtlchave'
      'FROM mes,'
      '     rfm,'
      '     rfi,'
      '     etd'
      'WHERE mes.meschave = rfm.meschave'
      'AND rfm.rfichave = rfi.rfichave'
      'AND rfi.tfdcodigo = 2'
      'AND rfi.tfIcodigo <> 6'
      'AND mes.meschave =:meschave'
      'AND mes.flacodigo =:flacodigo'
      'AND mes.mesrefeicao = 0'
      'AND mes.etdcodigo = etd.etdcodigo'
      'AND mes.sdecodigo <> '#39'02'#39
      'AND (rfi.tficodigo in (9));'
      '-- Filtros  ')
    Left = 952
    Top = 495
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'meschave'
        Value = nil
      end
      item
        DataType = ftUnknown
        Name = 'flacodigo'
        Value = nil
      end>
  end
  object tit: TUniQuery
    SQL.Strings = (
      'SELECT tit.titcodigo FROM tit '
      '  INNER JOIN rfi ON tit.titcodigo = rfi.titcodigo'
      '  INNER JOIN rfm ON rfi.rfichave = rfm.rfichave'
      '  INNER JOIN mes ON rfm.meschave = mes.meschave'
      'where mes.meschave=:meschave'
      'and mes.flacodigo=:flacodigo')
    Left = 1000
    Top = 483
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'meschave'
        Value = nil
      end
      item
        DataType = ftUnknown
        Name = 'flacodigo'
        Value = nil
      end>
    object tittitcodigo: TIntegerField
      FieldName = 'titcodigo'
    end
  end
  object mesrefeicao: TUniQuery
    SQL.Strings = (
      'SELECT mes.meschave, mdacodigo, mesvalor '
      '  '
      '  FROM mes  '
      '  JOIN toe        ON mes.toecodigo = toe.toecodigo '
      ' '
      ' WHERE toe.ttecodigo=(1) '
      '       and toe.ttocodigo not in( 10,8,3) '
      '       and mes.mesrefeicao=1 '
      '       and mes.meschave=:meschave'
      '       and mes.mesvalor=:mesvalor'
      '')
    Left = 60
    Top = 392
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'meschave'
        Value = nil
      end
      item
        DataType = ftUnknown
        Name = 'mesvalor'
        Value = nil
      end>
  end
  object ACBrNFeNFCe: TACBrNFe
    Configuracoes.Geral.SSLLib = libOpenSSL
    Configuracoes.Geral.SSLCryptLib = cryOpenSSL
    Configuracoes.Geral.SSLHttpLib = httpOpenSSL
    Configuracoes.Geral.SSLXmlSignLib = xsLibXml2
    Configuracoes.Geral.FormatoAlerta = 'TAG:%TAGNIVEL% ID:%ID%/%TAG%(%DESCRICAO%) - %MSG%.'
    Configuracoes.Geral.ValidarDigest = False
    Configuracoes.Geral.ModeloDF = moNFCe
    Configuracoes.Geral.AtualizarXMLCancelado = True
    Configuracoes.Arquivos.OrdenacaoPath = <>
    Configuracoes.Arquivos.SalvarApenasNFeProcessadas = True
    Configuracoes.WebServices.Visualizar = True
    Configuracoes.WebServices.UF = 'SP'
    Configuracoes.WebServices.AguardarConsultaRet = 3000
    Configuracoes.WebServices.IntervaloTentativas = 2000
    Configuracoes.WebServices.AjustaAguardaConsultaRet = True
    Configuracoes.WebServices.Salvar = True
    Configuracoes.WebServices.TimeOutPorThread = True
    Configuracoes.WebServices.QuebradeLinha = '|'
    Configuracoes.RespTec.IdCSRT = 0
    Left = 960
    Top = 232
  end
end
