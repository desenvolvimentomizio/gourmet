inherited framnc: Tframnc
  inherited PlGeral: TPanel
    inherited PlLista: TPanel
      inherited SplLista: TSplitter
        Top = 436
        Visible = True
        ExplicitTop = 430
      end
      inherited PlRodaPe: TPanel
        Top = 441
        Height = 139
        Visible = True
        ExplicitTop = 441
        ExplicitHeight = 139
        object PlRodapeItens: TPanel
          Left = 0
          Top = 112
          Width = 1034
          Height = 27
          Align = alBottom
          BevelOuter = bvNone
          TabOrder = 0
          object pquanti: TPanel
            Left = 0
            Top = 0
            Width = 130
            Height = 27
            Align = alLeft
            Alignment = taRightJustify
            BevelInner = bvLowered
            BorderWidth = 2
            Font.Charset = EASTEUROPE_CHARSET
            Font.Color = clNavy
            Font.Height = -12
            Font.Name = 'Tahoma'
            Font.Style = [fsBold]
            ParentFont = False
            TabOrder = 0
          end
          object pvalor: TPanel
            Left = 130
            Top = 0
            Width = 130
            Height = 27
            Align = alLeft
            Alignment = taRightJustify
            BevelInner = bvLowered
            BorderWidth = 2
            Font.Charset = EASTEUROPE_CHARSET
            Font.Color = clNavy
            Font.Height = -12
            Font.Name = 'Tahoma'
            Font.Style = [fsBold]
            ParentFont = False
            TabOrder = 1
          end
          object pdesconto: TPanel
            Left = 260
            Top = 0
            Width = 130
            Height = 27
            Align = alLeft
            Alignment = taRightJustify
            BevelInner = bvLowered
            BorderWidth = 2
            Font.Charset = EASTEUROPE_CHARSET
            Font.Color = clNavy
            Font.Height = -12
            Font.Name = 'Tahoma'
            Font.Style = [fsBold]
            ParentFont = False
            TabOrder = 2
          end
          object ptotal: TPanel
            Left = 390
            Top = 0
            Width = 130
            Height = 27
            Align = alLeft
            Alignment = taRightJustify
            BevelInner = bvLowered
            BorderWidth = 2
            Font.Charset = EASTEUROPE_CHARSET
            Font.Color = clNavy
            Font.Height = -12
            Font.Name = 'Tahoma'
            Font.Style = [fsBold]
            ParentFont = False
            TabOrder = 3
          end
          object pgeral: TPanel
            Left = 520
            Top = 0
            Width = 188
            Height = 27
            Align = alLeft
            Alignment = taRightJustify
            BevelInner = bvLowered
            BorderWidth = 2
            Font.Charset = EASTEUROPE_CHARSET
            Font.Color = clNavy
            Font.Height = -12
            Font.Name = 'Tahoma'
            Font.Style = [fsBold]
            ParentFont = False
            TabOrder = 4
          end
        end
        object listaitm: TDBGrid
          Left = 0
          Top = 0
          Width = 847
          Height = 112
          Align = alClient
          BorderStyle = bsNone
          Color = clCream
          DataSource = Ditm
          DrawingStyle = gdsGradient
          Options = [dgTitles, dgIndicator, dgColumnResize, dgColLines, dgRowLines, dgTabs, dgRowSelect, dgConfirmDelete, dgCancelOnExit, dgTitleClick, dgTitleHotTrack]
          PopupMenu = MenuManutencao
          TabOrder = 1
          TitleFont.Charset = DEFAULT_CHARSET
          TitleFont.Color = clWindowText
          TitleFont.Height = -11
          TitleFont.Name = 'Tahoma'
          TitleFont.Style = []
          OnDrawColumnCell = listaitmDrawColumnCell
          Columns = <
            item
              Expanded = False
              FieldName = 'itmchave'
              Width = 55
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmitem'
              Width = 30
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'proncm'
              Width = 65
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'procodigo'
              Width = 50
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'pronome'
              Width = 345
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'unisimbolo'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmvalor'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmquantidade'
              Width = 60
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmdesconto'
              Width = 50
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmliquido'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'cfocfop'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmaliqipi'
              Width = 30
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmpis'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmcofins'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmipi'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmicm'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'itmicms'
              Visible = True
            end>
        end
        object pdetalhe: TPanel
          Left = 847
          Top = 0
          Width = 187
          Height = 112
          Align = alRight
          BevelOuter = bvNone
          BorderWidth = 2
          TabOrder = 2
          object Panel3: TPanel
            Left = 2
            Top = 2
            Width = 183
            Height = 20
            Align = alTop
            Alignment = taLeftJustify
            BevelOuter = bvLowered
            Caption = '          Finaliza'#231#227'o Financeira da Venda'
            Color = 4210816
            Font.Charset = DEFAULT_CHARSET
            Font.Color = clYellow
            Font.Height = -12
            Font.Name = 'MS Sans Serif'
            Font.Style = [fsBold]
            ParentBackground = False
            ParentFont = False
            TabOrder = 0
          end
          object listapor: TDBGrid
            Left = 2
            Top = 42
            Width = 183
            Height = 68
            Align = alClient
            Color = 13303780
            DataSource = DSTotaisDtls
            DrawingStyle = gdsGradient
            Options = [dgTitles, dgColumnResize, dgColLines, dgRowLines, dgRowSelect, dgAlwaysShowSelection, dgConfirmDelete, dgCancelOnExit]
            TabOrder = 1
            TitleFont.Charset = DEFAULT_CHARSET
            TitleFont.Color = clWindowText
            TitleFont.Height = -11
            TitleFont.Name = 'Tahoma'
            TitleFont.Style = []
            Columns = <
              item
                Expanded = False
                FieldName = 'mdaidentificacao'
                Width = 70
                Visible = True
              end
              item
                Expanded = False
                FieldName = 'dtlvalor'
                Width = 70
                Visible = True
              end>
          end
          object pvalordetalhe: TPanel
            Left = 2
            Top = 22
            Width = 183
            Height = 20
            Align = alTop
            Alignment = taRightJustify
            BevelOuter = bvLowered
            BorderWidth = 2
            Caption = 'Dinheiro R$ 0,00'
            Font.Charset = DEFAULT_CHARSET
            Font.Color = clWindowText
            Font.Height = -15
            Font.Name = 'MS Sans Serif'
            Font.Style = [fsBold]
            ParentFont = False
            TabOrder = 2
            Visible = False
          end
        end
      end
      inherited PlFiltros: TPanel
        inherited PlEdTextoBusca: TPanel
          inherited GrBTextoProcurar: TGroupBox
            inherited PlGbEdtBusca: TPanel
              inherited edbusca: TEdit
                Color = 11206655
              end
            end
          end
        end
        inherited PlBotaoFiltroEsp2: TPanel
          Enabled = True
          Visible = True
        end
      end
      inherited PnlGrid: TPanel
        Height = 307
        ExplicitHeight = 307
        inherited DBGLista: TDBGrid
          Height = 281
          Columns = <
            item
              Expanded = False
              FieldName = 'meschave'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesregistro'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesemissao'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'temcodigo'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'temidentificacao'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'toeidentificacao'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'ttecodigo'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'tteidentificacao'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'tdfidentificacao'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'sdecodigo'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'sdeidentificacao'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'messerie'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesnumero'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'etdcodigo'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'etdidentificacao'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesvalor'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesdesconto'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mestotal'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesprodutos'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'messervicos'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'clbcodigo'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'trmcodigo'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mespis'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mescofins'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesipi'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesicm'
              Visible = True
            end
            item
              Expanded = False
              FieldName = 'mesicms'
              Visible = True
            end>
        end
        inherited PnlRodapeGrid: TPanel
          Top = 281
          Height = 26
          Visible = True
          ExplicitTop = 281
          ExplicitHeight = 26
          object Pnl1: TPanel
            Left = 1
            Top = 1
            Width = 1032
            Height = 23
            Align = alTop
            BevelOuter = bvNone
            Color = 5356845
            ParentBackground = False
            TabOrder = 0
            object Pltotalsaidas: TPanel
              Left = 0
              Top = 0
              Width = 170
              Height = 23
              Align = alLeft
              Alignment = taRightJustify
              BevelInner = bvLowered
              BevelOuter = bvNone
              BorderWidth = 2
              Caption = 'Sa'#237'das'
              Color = 5356845
              Font.Charset = EASTEUROPE_CHARSET
              Font.Color = clWhite
              Font.Height = -12
              Font.Name = 'Tahoma'
              Font.Style = [fsBold]
              ParentBackground = False
              ParentFont = False
              TabOrder = 0
            end
            object Pltotaldescontossaidas: TPanel
              Left = 170
              Top = 0
              Width = 152
              Height = 23
              Align = alLeft
              Alignment = taRightJustify
              BevelInner = bvLowered
              BevelOuter = bvNone
              BorderWidth = 2
              Caption = 'Descontos'
              Color = 5356845
              Font.Charset = EASTEUROPE_CHARSET
              Font.Color = clWhite
              Font.Height = -12
              Font.Name = 'Tahoma'
              Font.Style = [fsBold]
              ParentBackground = False
              ParentFont = False
              TabOrder = 1
            end
            object Pltotalliquidosaidas: TPanel
              Left = 322
              Top = 0
              Width = 170
              Height = 23
              Align = alLeft
              Alignment = taRightJustify
              BevelInner = bvLowered
              BevelOuter = bvNone
              BorderWidth = 2
              Caption = 'L'#205'QUIDO'
              Color = 5356845
              Font.Charset = EASTEUROPE_CHARSET
              Font.Color = clWhite
              Font.Height = -12
              Font.Name = 'Tahoma'
              Font.Style = [fsBold]
              ParentBackground = False
              ParentFont = False
              TabOrder = 2
            end
            object Pltotalnfesaidas: TPanel
              Left = 492
              Top = 0
              Width = 170
              Height = 23
              Align = alLeft
              Alignment = taRightJustify
              BevelInner = bvLowered
              BevelOuter = bvNone
              BorderWidth = 2
              Caption = 'NFE Emitidas'
              Color = 5356845
              Font.Charset = EASTEUROPE_CHARSET
              Font.Color = clWhite
              Font.Height = -12
              Font.Name = 'Tahoma'
              Font.Style = [fsBold]
              ParentBackground = False
              ParentFont = False
              TabOrder = 3
            end
          end
        end
      end
    end
  end
  inherited acoes: TActionList
    Left = 732
    Top = 180
    object ActImprimirVendaNFCE: TAction [0]
      Category = 'NFCEs'
      Caption = 'Gerar NFCe'
      OnExecute = ActImprimirVendaNFCEExecute
    end
    object ActReenviar: TAction [1]
      Category = 'NFCEs'
      Caption = 'Reenviar NFCe'
    end
    object ActGerarNova: TAction [2]
      Category = 'NFCEs'
      Caption = 'Gerar Nova NFCe'
      OnExecute = ActGerarNovaExecute
    end
    object ActGerarNovaVenda: TAction [3]
      Category = 'NFCEs'
      Caption = 'Gerar Nova Venda'
      OnExecute = ActGerarNovaVendaExecute
    end
    object ActAjustarEntidadeNFCE: TAction [4]
      Category = 'NFCEs - Ajustar'
      Caption = 'Cliente Completo'
      OnExecute = ActAjustarEntidadeNFCEExecute
    end
    object ActVeriricarPendentes: TAction [5]
      Category = 'NFCEs'
      Caption = 'Verificar Pendentes'
      OnExecute = ActVeriricarPendentesExecute
    end
    object ActVerificarStatus: TAction [6]
      Category = 'NFCEs'
      Caption = 'Verificar Status'
      OnExecute = ActVerificarStatusExecute
    end
    object ActAjustarEntidadeSimplesNFCE: TAction [7]
      Category = 'NFCEs - Ajustar'
      Caption = 'Cliente Simplificado'
      OnExecute = ActAjustarEntidadeSimplesNFCEExecute
    end
    object ActReimprimirNFCE: TAction
      Category = 'NFCEs'
      Caption = 'Reimprimir NFCe'
      OnExecute = ActReimprimirNFCEExecute
    end
    object ActVisualizarNFCE: TAction
      Category = 'NFCEs'
      Caption = 'Visualizar NFCE'
      OnExecute = ActVisualizarNFCEExecute
    end
    object ActRenviaremail: TAction
      Category = 'NFCEs'
      Caption = 'Enviar email da NFCe'
      OnExecute = ActRenviaremailExecute
    end
    object ActInutilizar: TAction
      Category = 'NFCEs'
      Caption = 'Inutilizar Numera'#231#227'o'
      OnExecute = ActInutilizarExecute
    end
    object ActSelecionarChaveNFE: TAction
      Category = 'NFCEs'
      Caption = 'Copiar Chave NFCe'
      OnExecute = ActSelecionarChaveNFEExecute
    end
    object ActConsultaStatusSEFAZ: TAction
      Category = 'NFCEs - Consulta'
      Caption = 'Status SEFAZ'
      OnExecute = ActConsultaStatusSEFAZExecute
    end
    object ActConsultaStatusAjustarNFCESEFAZMT: TAction
      Category = 'NFCEs - Consulta'
      Caption = 'NFCE - Consulta'
      OnExecute = ActConsultaStatusAjustarNFCESEFAZMTExecute
    end
    object ActCancelarNFCE: TAction
      Category = 'NFCEs - Eventos'
      Caption = 'Cancelar NFCE'
      OnExecute = ActCancelarNFCEExecute
    end
    object ActConsolidarSEFAZ: TAction
      Category = 'NFCEs - Consulta'
      Caption = 'Consolidar com SEFAZ'
    end
    object ActGerarXML: TAction
      Category = 'NFCEs'
      Caption = 'Regerar XML'
      OnExecute = ActGerarXMLExecute
    end
    object ActGerarXMLCont: TAction
      Category = 'NFCEs'
      Caption = 'Regerar XML Cont'
      OnExecute = ActGerarXMLContExecute
    end
    object ActSalvarXMLS: TAction
      Category = 'NFCEs'
      Caption = 'Salvar XMLS'
      OnExecute = ActSalvarXMLSExecute
    end
    object ActReGerarXML: TAction
      Category = 'NFCEs'
      Caption = 'ReGerar XMLs'
      OnExecute = ActReGerarXMLExecute
    end
  end
  inherited MenuManutencao: TPopupMenu
    object mnUtilitarios: TMenuItem [8]
      Caption = 'Utilit'#225'rios'
      object RegerarXMLTODASdetodasemContigencia1: TMenuItem
        Caption = 'Regerar XML TODAS de todas em Contigencia'
        OnClick = RegerarXMLTODASdetodasemContigencia1Click
      end
      object ConultasTODASasnotas1: TMenuItem
        Caption = 'Conultas TODAS as notas'
        OnClick = ConultasTODASasnotas1Click
      end
    end
  end
  inherited uqtabela: TUniQuery
    SQL.Strings = (
      'SELECT'
      '  mes.meschave,'
      '  IF((SELECT'
      '      COUNT(micchave)'
      '    FROM mic'
      
        '    WHERE mic.meschave = mes.meschave) > 0, CONCAT(etd.etdidenti' +
        'ficacao, '#39' '#39', (SELECT'
      '      idcnome'
      '    FROM idc,'
      '         mic'
      '    WHERE idc.idccodigo = mic.idccodigo'
      
        '    AND mic.meschave = mes.meschave)), etd.etdidentificacao) AS ' +
        'etdidentificacao,'
      '  sde.sdeidentificacao,'
      '  tdf.tdfidentificacao,'
      '  toe.toeidentificacao,'
      '  mes.mesemissao,'
      '  mes.mesnumero,'
      '  mes.etdcodigo,'
      '  mes.messerie,'
      '  meschavenfe,'
      '  mes.mesregistro,'
      '  mes.mesvalor,'
      '  mes.mesdesconto,'
      '  mes.mestotal,'
      '  mes.temcodigo,'
      '  mes.clbcodigo,'
      '  mes.trmcodigo,'
      '  mesprotocolo,'
      '  mes.sdecodigo,'
      '  mesdatanfe,'
      '  toeorigem,'
      '  mes.tdfcodigo,'
      '  toe.ttecodigo,'
      '  tte.tteidentificacao,'
      '  temidentificacao,'
      '  mesprodutos,'
      '  messervicos,'
      '  toe.ttocodigo,'
      '  mes.mespis,'
      '  mes.mescofins,'
      '  mes.mesipi,'
      '  mes.mesicm,'
      '  mes.mesicms,'
      '  mes.flacodigo,'
      'mes.mescodigonota'
      ''
      ''
      'FROM mes,'
      '     etd,'
      '     sde,'
      '     tdf,'
      '     toe,'
      '     tte,'
      '     tem'
      'WHERE etd.etdcodigo = mes.etdcodigo'
      'AND mes.temcodigo = tem.temcodigo'
      'AND sde.sdecodigo = mes.sdecodigo'
      'AND tte.ttecodigo = toe.ttecodigo'
      'AND tdf.tdfcodigo = mes.tdfcodigo'
      'AND toe.toecodigo = mes.toecodigo'
      'AND toe.ttmcodigo = 0'
      'AND toe.ttecodigo = 1'
      'AND mes.tdfcodigo NOT IN ('#39'01'#39', '#39'2D'#39', '#39'AF'#39', '#39'RF'#39', '#39'CE'#39', '#39'55'#39')'
      
        'AND IF(mes.sdecodigo = '#39'02'#39', NOT mes.tdfcodigo = '#39'00'#39', toe.ttmco' +
        'digo = 0)')
    object uqtabelameschave: TIntegerField
      AutoGenerateValue = arAutoInc
      DisplayLabel = 'Nr. Chave'
      FieldName = 'meschave'
    end
    object uqtabelamesemissao: TDateField
      DisplayLabel = 'Emiss'#227'o'
      FieldName = 'mesemissao'
      EditMask = '!99/99/0000;1;_'
    end
    object uqtabelatdfidentificacao: TStringField
      DisplayLabel = 'Tipo Documento'
      FieldName = 'tdfidentificacao'
      Size = 50
    end
    object uqtabelamesnumero: TIntegerField
      DisplayLabel = 'Nr. Documento'
      FieldName = 'mesnumero'
    end
    object uqtabelaetdcodigo: TIntegerField
      DisplayLabel = 'C'#243'digo'
      FieldName = 'etdcodigo'
    end
    object uqtabelaetdidentificacao: TStringField
      DisplayLabel = 'Cliente'
      FieldName = 'etdidentificacao'
      Size = 50
    end
    object uqtabelamesvalor: TFloatField
      DisplayLabel = 'Total R$'
      FieldName = 'mesvalor'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelamesdesconto: TFloatField
      DisplayLabel = 'Desconto R$'
      FieldName = 'mesdesconto'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelamestotal: TFloatField
      DisplayLabel = 'Total L'#237'quido R$'
      FieldName = 'mestotal'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelasdeidentificacao: TStringField
      DisplayLabel = 'Situa'#231#227'o Documento'
      FieldName = 'sdeidentificacao'
      Required = True
      Size = 50
    end
    object uqtabelatoeidentificacao: TStringField
      DisplayLabel = 'Destina'#231#227'o'
      FieldName = 'toeidentificacao'
      Required = True
      Size = 50
    end
    object uqtabelamesserie: TStringField
      DisplayLabel = 'S'#233'rie'
      FieldName = 'messerie'
      Size = 5
    end
    object uqtabelaclbcodigo: TIntegerField
      DisplayLabel = 'Clb'
      FieldName = 'clbcodigo'
      Required = True
    end
    object uqtabelatrmcodigo: TIntegerField
      DisplayLabel = 'Trm'
      FieldName = 'trmcodigo'
      Required = True
    end
    object uqtabelamesprotocolo: TStringField
      FieldName = 'mesprotocolo'
      Size = 50
    end
    object uqtabelasdecodigo: TStringField
      DisplayLabel = 'C'#243'd. Situa'#231#227'o'
      FieldName = 'sdecodigo'
      Size = 2
    end
    object uqtabelamesdatanfe: TDateField
      DisplayLabel = 'Data NFE'
      FieldName = 'mesdatanfe'
    end
    object uqtabelatemcodigo: TIntegerField
      DisplayLabel = 'Cod. Est'#225'gio'
      FieldName = 'temcodigo'
    end
    object uqtabelatemidentificacao: TStringField
      DisplayLabel = 'Est'#225'gio'
      FieldName = 'temidentificacao'
    end
    object uqtabelatoeorigem: TStringField
      FieldName = 'toeorigem'
      Size = 1
    end
    object uqtabelatdfcodigo: TStringField
      FieldName = 'tdfcodigo'
      Size = 2
    end
    object uqtabelattecodigo: TIntegerField
      DisplayLabel = 'Cod. Tipo Mov.'
      FieldName = 'ttecodigo'
    end
    object uqtabelatteidentificacao: TStringField
      Tag = 999
      DisplayLabel = 'Tipo Mov.'
      FieldName = 'tteidentificacao'
      Size = 35
    end
    object uqtabelameschavenfe: TStringField
      FieldName = 'meschavenfe'
      Size = 100
    end
    object uqtabelamesregistro: TDateField
      DisplayLabel = 'Registro'
      FieldName = 'mesregistro'
    end
    object uqtabelamesprodutos: TFloatField
      DisplayLabel = 'Produtos R$'
      FieldName = 'mesprodutos'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelamesservicos: TFloatField
      DisplayLabel = 'Servi'#231'os R$'
      FieldName = 'messervicos'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelattocodigo: TIntegerField
      FieldName = 'ttocodigo'
    end
    object uqtabelamespis: TFloatField
      DisplayLabel = 'PIS'
      FieldName = 'mespis'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelamescofins: TFloatField
      DisplayLabel = 'Cofins'
      FieldName = 'mescofins'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelamesipi: TFloatField
      DisplayLabel = 'IPI'
      FieldName = 'mesipi'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelamesicm: TFloatField
      DisplayLabel = 'ICM'
      FieldName = 'mesicm'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelamesicms: TFloatField
      DisplayLabel = 'ICM-Subst.'
      FieldName = 'mesicms'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object uqtabelaflacodigo: TIntegerField
      FieldName = 'flacodigo'
    end
    object uqtabelamescodigonota: TIntegerField
      FieldName = 'mescodigonota'
    end
  end
  inherited vcls: TVirtualTable
    Data = {04000000000000000000}
  end
  inherited ColorDialog: TColorDialog
    Left = 976
    Top = 341
  end
  inherited ImageList1: TImageList
    Bitmap = {
      494C010103000500140010001000FFFFFFFFFF10FFFFFFFFFFFFFFFF424D3600
      0000000000003600000028000000400000001000000001002000000000000010
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000000000000000000000EDED
      ED001D1D1D000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000001818
      1800272727000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      00000000000000000000000000007F7F7F007F7F7F0000000000000000000000
      0000000000000000000000000000000000000000000000000000000000002A2A
      2A002A2A2A000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000007F7F7F0000000000000000007F7F7F00000000000000
      0000000000000000000000000000000000000000000000000000FDFDFD001C1C
      1C001C1C1C00FDFDFD0000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      00000000000000000000000000006F6F6F006F6F6F0000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000007F7F7F00000000000000000000000000000000007F7F7F000000
      0000000000000000000000000000000000000000000000000000282828000000
      0000000000002828280000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000007F7F7F0000000000000000007F7F7F00000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      00007F7F7F000000000000000000000000000000000000000000000000007F7F
      7F00000000000000000000000000000000000000000035353500000000000000
      0000000000000000000035353500000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000007F7F7F00000000000000000000000000000000007F7F7F000000
      0000000000000000000000000000000000000000000000000000000000007F7F
      7F00000000000000000000000000000000000000000000000000000000000000
      00007F7F7F000000000000000000000000000000000000000000000000000000
      00000000000000000000000000000000000000000000E1E1E100E1E1E1000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      00006F6F6F000000000000000000000000000000000000000000000000006F6F
      6F000000000000000000000000000000000000000000000000007F7F7F000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000007F7F7F0000000000000000000000000000000000000000000000
      000000000000000000000000000000000000DDDDDD001313130013131300DDDD
      DD00000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000000000007F7F7F00000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000007F7F7F00000000000000000000000000000000000000
      0000000000000000000000000000F7F7F7001919190000000000000000001919
      1900F7F7F7000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000007F7F7F0000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      00000000000000000000000000007F7F7F000000000000000000000000000000
      00000000000000000000E4E4E400070707000000000000000000000000000000
      000007070700E4E4E40000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000DBDBDB0010101000000000000000000000000000000000000000
      00000000000010101000DBDBDB00000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000009C9C9C00737373007F7F7F007F7F7F007F7F7F007F7F7F007F7F
      7F007F7F7F00737373009C9C9C00000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      0000000000000000000000000000000000000000000000000000000000000000
      000000000000000000000000000000000000424D3E000000000000003E000000
      2800000040000000100000000100010000000000800000000000000000000000
      000000000000000000000000FFFFFF00FFFFFFFFFFFF0000FFFFFFFFFFFF0000
      FFFFFFFFE7FF0000FFFFFFFFE7FF0000FFFFFE7FE7FF0000FFFFFC3FC3FF0000
      FE7FF81FC3FF0000FC3FF00F81FF0000F81FE007FF9F0000F00FC003FF0F0000
      FFFF8001FE070000FFFF0000FC030000FFFFFFFFF8010000FFFFFFFFF8010000
      FFFFFFFFFFFF0000FFFFFFFFFFFF000000000000000000000000000000000000
      000000000000}
  end
  inherited DBGrid2Excel: TDBGrid2Excel
    Left = 1064
    Top = 341
  end
  object cfg: TUniQuery
    SQL.Strings = (
      'SELECT'
      '  /*Principal*/'
      '  cfgmcfg.cfgcodigo,'
      '  cfgmcfg.cfgetdempresa,'
      ''
      '  /*Entradas*/'
      '  cfgment.cfgprouso,'
      '  cfgment.cfgtoeusofora,'
      '  cfgment.cfgtoeusointe,'
      ''
      '  /*Sa'#237'das*/'
      '  cfgmsai.cfgtoecuffora,'
      '  cfgmsai.cfgtoecufinte,'
      ''
      '  /*Contas a Receber*/'
      '  cfgmcre.cfgviaassinar,'
      ''
      '  /*Emiss'#227'o NFe*/'
      '  cfgmnfe.cfgviasnfe,'
      '  cfgmnfe.cfgnumeronfe,'
      '  cfgmnfe.cfgserienfe,'
      '  cfgmnfe.cfgnumeronfce,'
      '  cfgmnfe.cfgserienfce,'
      '  cfgmnfe.cfgobs1,'
      '  cfgmnfe.cfgobs2,'
      '  cfgmnfe.cfgobs3,'
      '  cfgmnfe.cfgobs4,'
      '  cfgmnfe.cfgdescrinfe,'
      '  cfgmnfe.cfgnumecertif,'
      '  cfgmnfe.cfgnumecertifa1,'
      '  cfgmnfe.cfgsenhacertificadoa1,'
      '  cfgmnfe.cfgtoken1nfce,'
      '  cfgmnfe.cfgidtokennfce,'
      '  cfgmnfe.cfgmodonfe,'
      ''
      ''
      '  /*Email*/'
      '  cfgmnfe.cfgemailnfe,'
      '  cfgmnfe.cfgemailservidornfe,'
      '  cfgmnfe.cfgemailsenhanfe,'
      '  cfgmnfe.cfgmailportnfe,'
      '  cfgmnfe.cfgemailusatls,'
      '  cfgmsai.cfgmensagempdv,'
      ''
      '  /*SPED*/'
      '  cfgmcfg.crtcodigo,'
      '  cfgmspd.cfgcstterceiros,'
      ''
      '  /*Dados da Empresa*/'
      '  etd.etdapelido,'
      '  etd.etdidentificacao,'
      '  etd.etddoc1,'
      ''
      '  edr.ufscodigo,'
      '  edr.cddcodigo,'
      '  edr.edrinscest,'
      '  edr.edrrua,'
      '  edr.edrnumero,'
      '  edr.edrbairro,'
      '  edr.edrcep,'
      '  cdd.cddnome,'
      '  ufs.ufssigla,'
      ''
      '  etf.etftelefone,'
      '  '
      '  /*Box-e - Dom'#237'nio Sistemas*/'
      '  ctd.ctdboxedominio,'
      '  cfgmensagempdv,'
      '  cfgtrmimpfis1,'
      '  cfgtrmimpfis2,'
      '  cfgtrmtef1,'
      '  cfgtrmtef2,'
      '  cfgimpnfe1,'
      '  cfgimpnfe2,'
      '  cfgimpnfc1,'
      '  cfgimpnfc2,'
      '  cfgimpnfc3,'
      '  cfgservarqnfes,'
      '  cfg.cfgusanfc'
      'FROM cfgmcfg,'
      '     ufs,'
      '     etd,'
      '     cfgmnfe,'
      '     cfgment,'
      '     cfgmcre,'
      '     edr,'
      '     cfg,'
      '     cfgmspd,'
      '     etf,'
      '     cdd,'
      '     cfgmsai,'
      '     ctd'
      'WHERE cfg.cfgcodigo = ctd.cfgcodigo'
      'AND cfg.cfgcodigo = cfgmsai.cfgcodigo'
      'AND ufs.ufscodigo = edr.ufscodigo'
      'AND cfg.cfgcodigo = cfgmcfg.cfgcodigo'
      'AND cfg.cfgcodigo = cfgmcre.cfgcodigo'
      'AND etd.etdcodigo = etf.etdcodigo'
      'AND etf.ttfcodigo = 1'
      'AND edr.cddcodigo = cdd.cddcodigo'
      'AND cfg.cfgcodigo = cfgment.cfgcodigo'
      'AND cfg.cfgcodigo = cfgmnfe.cfgcodigo'
      'AND etd.etdcodigo = cfgmcfg.cfgetdempresa'
      'AND etd.etdcodigo = edr.etdcodigo'
      'AND edr.tedcodigo = 1'
      'AND cfg.cfgcodigo = cfgmspd.cfgcodigo'
      'AND cfg.flacodigo = :flacodigo')
    Left = 866
    Top = 228
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'flacodigo'
        Value = nil
      end>
    object cfgcfgcodigo: TIntegerField
      FieldName = 'cfgcodigo'
      Required = True
    end
    object cfgcfgservarqnfes: TStringField
      FieldName = 'cfgservarqnfes'
      Size = 100
    end
    object cfgcfgnumecertif: TStringField
      FieldName = 'cfgnumecertif'
      Size = 100
    end
    object cfgcfgetdempresa: TIntegerField
      FieldName = 'cfgetdempresa'
    end
    object cfgcfgviasnfe: TIntegerField
      FieldName = 'cfgviasnfe'
      Required = True
    end
    object cfgcfgserienfe: TStringField
      FieldName = 'cfgserienfe'
      Size = 5
    end
    object cfgcfgserienfce: TStringField
      FieldName = 'cfgserienfce'
      Size = 5
    end
    object cfgcfgdescrinfe: TIntegerField
      FieldName = 'cfgdescrinfe'
      Required = True
    end
    object cfgcfgemailnfe: TStringField
      FieldName = 'cfgemailnfe'
      Size = 50
    end
    object cfgcfgemailservidornfe: TStringField
      FieldName = 'cfgemailservidornfe'
      Size = 50
    end
    object cfgcfgemailsenhanfe: TStringField
      FieldName = 'cfgemailsenhanfe'
      Size = 50
    end
    object cfgcfgmailportnfe: TStringField
      FieldName = 'cfgmailportnfe'
      Required = True
      Size = 5
    end
    object cfgcfgemailusatls: TIntegerField
      FieldName = 'cfgemailusatls'
      Required = True
    end
    object cfgcrtcodigo: TIntegerField
      FieldName = 'crtcodigo'
      Required = True
    end
    object cfgetdapelido: TStringField
      FieldName = 'etdapelido'
      Size = 100
    end
    object cfgetdidentificacao: TStringField
      FieldName = 'etdidentificacao'
      Required = True
      Size = 50
    end
    object cfgetddoc1: TStringField
      FieldName = 'etddoc1'
    end
    object cfgufscodigo: TStringField
      FieldName = 'ufscodigo'
      Required = True
      Size = 10
    end
    object cfgcddcodigo: TStringField
      FieldName = 'cddcodigo'
      Required = True
      Size = 10
    end
    object cfgedrinscest: TStringField
      FieldName = 'edrinscest'
      Required = True
    end
    object cfgedrrua: TStringField
      FieldName = 'edrrua'
      Required = True
      Size = 50
    end
    object cfgedrnumero: TStringField
      FieldName = 'edrnumero'
      Required = True
      Size = 10
    end
    object cfgedrbairro: TStringField
      FieldName = 'edrbairro'
      Required = True
      Size = 60
    end
    object cfgedrcep: TStringField
      FieldName = 'edrcep'
      Required = True
      Size = 10
    end
    object cfgcddnome: TStringField
      FieldName = 'cddnome'
      Required = True
      Size = 50
    end
    object cfgufssigla: TStringField
      FieldName = 'ufssigla'
      Required = True
      Size = 3
    end
    object cfgetftelefone: TStringField
      FieldName = 'etftelefone'
      Required = True
    end
    object cfgcfgusanfc: TIntegerField
      FieldName = 'cfgusanfc'
    end
    object cfgcfgtoken1nfce: TStringField
      FieldName = 'cfgtoken1nfce'
      Size = 100
    end
    object cfgcfgnumecertifa1: TStringField
      FieldName = 'cfgnumecertifa1'
      Size = 100
    end
    object cfgcfgmodonfe: TIntegerField
      FieldName = 'cfgmodonfe'
    end
    object cfgcfgsenhacertificadoa1: TStringField
      FieldName = 'cfgsenhacertificadoa1'
      Size = 50
    end
    object cfgcfgidtokennfce: TStringField
      FieldName = 'cfgidtokennfce'
      Size = 6
    end
    object cfgcfgviaassinar: TIntegerField
      FieldName = 'cfgviaassinar'
    end
    object cfgcfgmensagempdv: TStringField
      FieldName = 'cfgmensagempdv'
      Size = 250
    end
  end
  object itm: TUniQuery
    SQL.Strings = (
      'SELECT'
      '  pro.pronome,'
      '  itm.itmchave,'
      '  itm.meschave,'
      '  itm.itmitem,'
      '  itm.procodigo,'
      '  pro.proncm,'
      '  uni.unisimbolo,'
      '  itm.itmquantidade,'
      '  itm.itmvalor,'
      '  itm.itmdesconto,'
      '  itm.itmtotal,'
      '  itm.cfocfop,'
      '  itm.itmaliqipi,'
      '  (itm.itmtotal-itm.itmdesconto) as  itmliquido,'
      '  itm.itmpis,'
      '  itm.itmcofins,'
      '  itm.itmipi,'
      '  itm.itmicm,'
      '  itm.itmicms '
      'FROM itm,'
      '     pro,'
      '     pun,'
      '     uni'
      'WHERE pro.procodigo = itm.procodigo'
      'AND itm.puncodigo = pun.puncodigo'
      'AND uni.unicodigo = pun.unicodigo'
      'AND itm.meschave = :meschave'
      'ORDER BY itm.itmitem')
    Left = 732
    Top = 248
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'meschave'
        Value = nil
      end>
    object itmitmchave: TIntegerField
      AutoGenerateValue = arAutoInc
      DisplayLabel = 'Nr. Chave'
      FieldName = 'itmchave'
      ReadOnly = True
    end
    object itmmeschave: TIntegerField
      FieldName = 'meschave'
      ReadOnly = True
      Required = True
    end
    object itmitmitem: TIntegerField
      DisplayLabel = 'Item'
      FieldName = 'itmitem'
      ReadOnly = True
      Required = True
    end
    object itmprocodigo: TIntegerField
      DisplayLabel = 'Produto'
      FieldName = 'procodigo'
      ReadOnly = True
      Required = True
    end
    object itmpronome: TStringField
      DisplayLabel = 'Identifica'#231#227'o do Produto / Servi'#231'o'
      FieldName = 'pronome'
      Required = True
      Size = 150
    end
    object itmunisimbolo: TStringField
      DisplayLabel = 'UN'
      FieldName = 'unisimbolo'
      ReadOnly = True
      Required = True
      FixedChar = True
      Size = 6
    end
    object itmitmvalor: TFloatField
      DisplayLabel = 'Vlr Unit R$'
      FieldName = 'itmvalor'
      ReadOnly = True
      Required = True
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object itmitmquantidade: TFloatField
      DisplayLabel = 'Quant.'
      FieldName = 'itmquantidade'
      ReadOnly = True
      Required = True
      DisplayFormat = '#,###0.000'
      EditFormat = '#,###0.000'
    end
    object itmitmdesconto: TFloatField
      DisplayLabel = 'Desc. R$'
      FieldName = 'itmdesconto'
      ReadOnly = True
      Required = True
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object itmitmtotal: TFloatField
      DisplayLabel = 'Total Item R$'
      FieldName = 'itmtotal'
      ReadOnly = True
      Required = True
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object itmcfocfop: TStringField
      DisplayLabel = 'CFOP'
      FieldName = 'cfocfop'
      ReadOnly = True
      Required = True
      Size = 5
    end
    object itmitmpis: TFloatField
      DisplayLabel = 'PIS'
      FieldName = 'itmpis'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object itmitmcofins: TFloatField
      DisplayLabel = 'COFINS'
      FieldName = 'itmcofins'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object itmitmipi: TFloatField
      DisplayLabel = 'IPI'
      FieldName = 'itmipi'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object itmitmicm: TFloatField
      DisplayLabel = 'ICM'
      FieldName = 'itmicm'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object itmitmicms: TFloatField
      DisplayLabel = 'ICMS'
      FieldName = 'itmicms'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object itmitmaliqipi: TFloatField
      DisplayLabel = '% IPI'
      FieldName = 'itmaliqipi'
      DisplayFormat = '#,#0.0'
      EditFormat = '#,#0.0'
    end
    object itmproncm: TStringField
      DisplayLabel = 'NCM'
      FieldName = 'proncm'
      Size = 15
    end
    object itmitmliquido: TFloatField
      DisplayLabel = 'L'#237'quido R$'
      FieldName = 'itmliquido'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
  end
  object Ditm: TUniDataSource
    DataSet = itm
    Left = 768
    Top = 248
  end
  object mic: TUniQuery
    SQL.Strings = (
      
        'select micchave, idccodigo, meschave from mic where mic.meschave' +
        '=:meschave')
    Left = 824
    Top = 280
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'meschave'
        Value = nil
      end>
    object micmicchave: TIntegerField
      FieldName = 'micchave'
    end
    object micidccodigo: TIntegerField
      FieldName = 'idccodigo'
    end
    object micmeschave: TIntegerField
      FieldName = 'meschave'
    end
  end
  object mes: TUniQuery
    SQL.Strings = (
      'select meschave, etdcodigo from mes where meschave=:meschave')
    Left = 874
    Top = 172
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'meschave'
        Value = nil
      end>
    object mesmeschave: TIntegerField
      FieldName = 'meschave'
    end
    object mesetdcodigo: TIntegerField
      FieldName = 'etdcodigo'
    end
  end
  object mesnova: TUniQuery
    Left = 728
    Top = 349
  end
  object mesatual: TUniQuery
    Left = 680
    Top = 349
  end
  object mesxml: TUniQuery
    SQL.Strings = (
      'SELECT'
      '  meschave,'
      '  mesarqxml'
      'FROM mesxml'
      'where meschave=:meschave')
    Left = 832
    Top = 341
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'meschave'
        Value = nil
      end>
    object mesxmlmeschave: TIntegerField
      FieldName = 'meschave'
    end
    object mesxmlmesarqxml: TBlobField
      FieldName = 'mesarqxml'
    end
  end
  object OpenDialog: TOpenDialog
    Left = 896
    Top = 309
  end
  object TotaisDtls: TVirtualTable
    FieldDefs = <
      item
        Name = 'mdaidentificacao'
        DataType = ftString
        Size = 35
      end
      item
        Name = 'dtlvalor'
        DataType = ftFloat
        Precision = 15
      end
      item
        Name = 'mdacodigo'
        DataType = ftInteger
      end>
    Left = 1128
    Top = 540
    Data = {
      0400030010006D64616964656E74696669636163616F01002300000000000800
      64746C76616C6F72060000000F00000009006D6461636F6469676F0300000000
      000000000000000000}
    object TotaisDtlsmdaidentificacao: TStringField
      DisplayLabel = 'Modalidade'
      FieldName = 'mdaidentificacao'
      Size = 35
    end
    object TotaisDtlsdtlvalor: TFloatField
      DisplayLabel = 'Valor R$'
      FieldName = 'dtlvalor'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
    object TotaisDtlsmdacodigo: TIntegerField
      FieldName = 'mdacodigo'
    end
  end
  object DSTotaisDtls: TDataSource
    DataSet = TotaisDtls
    Left = 1064
    Top = 543
  end
  object dtl: TUniQuery
    SQL.Strings = (
      'SELECT distinct'
      '  mda.mdaidentificacao,'
      '  dtl.dtlvalor dtlvalor,'
      '  dtl.ltechave'
      ''
      ''
      'FROM rfm'
      '  INNER JOIN mes'
      '    ON rfm.meschave = mes.meschave'
      '    AND rfm.flacodigo = mes.flacodigo'
      '  INNER JOIN rfi'
      '    ON rfm.rfichave = rfi.rfichave'
      '    AND rfi.flacodigo = mes.flacodigo'
      '  INNER JOIN mfi'
      '    ON mfi.rfichave = rfi.rfichave'
      '    AND mfi.flacodigo = mes.flacodigo'
      '  LEFT JOIN mlt'
      '    ON mlt.mfichave = mfi.mfichave'
      '    AND mes.flacodigo = mlt.flacodigo'
      '  INNER JOIN dtl'
      '    ON dtl.ltechave = mlt.ltechave'
      '    AND mlt.flacodigo = dtl.flacodigo'
      '  LEFT JOIN mda'
      '    ON dtl.mdacodigo = mda.mdacodigo'
      '  LEFT JOIN lte'
      '    ON mlt.ltechave = lte.ltechave'
      '    AND mes.flacodigo = lte.flacodigo'
      'WHERE rfi.tfdcodigo IN (2, 32)'
      'AND IF(rfi.tfdcodigo = 2, mfi.tmfcodigo = 2, mfi.tmfcodigo)'
      'AND mes.tdfcodigo <> '#39'RF'#39
      'AND mes.mesrefeicao = 0'
      'AND mes.meschave = :meschave'
      'AND mes.flacodigo = :flacodigo'
      'AND '
      
        '  IF((SELECT cfgusaadc FROM cfg WHERE cfgcodigo = :flacodigo IN ' +
        '(0, 1))<>2  '
      '     , IF((dtl.mdacodigo = 4 OR dtl.mdacodigo = 5) '
      '     ,     if((select adcliquidaautomatico from adc limit 1)=0'
      '               ,tmfcodigo = 2  '
      '               ,tmfcodigo = 21) '
      '     , tmfcodigo = 21)'
      '     '
      '     ,  if((select adcliquidaautomatico from adc limit 1)=0'
      '     '
      '               , IF((dtl.mdacodigo = 4 OR dtl.mdacodigo = 5) '
      '     ,     if((select adcliquidaautomatico from adc limit 1)=0'
      '               ,tmfcodigo = 2  '
      '               ,tmfcodigo = 21) '
      '     , tmfcodigo = 21) '
      '               '
      '               ,tmfcodigo = 2)'
      '  )'
      ''
      ''
      '/* GROUP BY dtl.mdacodigo */'
      ''
      ''
      ''
      '/*SELECT distinct'
      '  mda.mdaidentificacao,'
      '  dtl.dtlvalor dtlvalor,'
      '  dtl.ltechave'
      ''
      ''
      'FROM rfm'
      '  INNER JOIN mes'
      '    ON rfm.meschave = mes.meschave'
      '    AND rfm.flacodigo = mes.flacodigo'
      '  INNER JOIN rfi'
      '    ON rfm.rfichave = rfi.rfichave'
      '    AND rfi.flacodigo = mes.flacodigo'
      '  INNER JOIN mfi'
      '    ON mfi.rfichave = rfi.rfichave'
      '    AND mfi.flacodigo = mes.flacodigo'
      '  LEFT JOIN mlt'
      '    ON mlt.mfichave = mfi.mfichave'
      '    AND mes.flacodigo = mlt.flacodigo'
      '  INNER JOIN dtl'
      '    ON dtl.ltechave = mlt.ltechave'
      '    AND mlt.flacodigo = dtl.flacodigo'
      '  LEFT JOIN mda'
      '    ON dtl.mdacodigo = mda.mdacodigo'
      '  LEFT JOIN lte'
      '    ON mlt.ltechave = lte.ltechave'
      '    AND mes.flacodigo = lte.flacodigo'
      'WHERE rfi.tfdcodigo IN (2, 32)'
      'AND IF(rfi.tfdcodigo = 2, mfi.tmfcodigo = 2, mfi.tmfcodigo)'
      'AND mes.tdfcodigo <> '#39'RF'#39
      'AND mes.mesrefeicao = 0'
      'AND mes.meschave = :meschave'
      'AND mes.flacodigo = :flacodigo'
      'AND IF((SELECT'
      '    cfgusaadc'
      '  FROM cfg'
      
        '  WHERE cfgcodigo = :flacodigo IN (0, 1))<>2,  IF((dtl.mdacodigo' +
        ' = 4 OR dtl.mdacodigo = 5), if((select adcliquidaautomatico from' +
        ' adc limit 1)=0,tmfcodigo = 2 , tmfcodigo = 21), tmfcodigo = 21)' +
        ',tmfcodigo = 21)'
      ''
      ''
      '-- GROUP BY dtl.mdacodigo */')
    Options.DetailDelay = 50
    Left = 1016
    Top = 544
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'meschave'
        Value = nil
      end
      item
        DataType = ftUnknown
        Name = 'flacodigo'
        Value = nil
      end>
    object dtlltechave: TIntegerField
      FieldName = 'ltechave'
    end
    object dtlmdaidentificacao: TStringField
      FieldName = 'mdaidentificacao'
      Size = 25
    end
    object dtldtlvalor: TFloatField
      FieldName = 'dtlvalor'
      DisplayFormat = '#,##0.00'
      EditFormat = '#,##0.00'
    end
  end
  object uqDtlConvenios: TUniQuery
    SQL.Strings = (
      'SELECT'
      '  '#39'Conv'#234'nio'#39' AS mdaidentificacao,'
      '  SUM(rfivalor) AS dtlvalor,'
      '  7 AS mdacodigo'
      'FROM mes,'
      '     rfm,'
      '     rfi,'
      '     etd'
      'WHERE mes.meschave = rfm.meschave'
      'AND rfm.rfichave = rfi.rfichave'
      'AND (rfi.tfdcodigo IN (2)'
      'AND mes.flacodigo = :flacodigo'
      'AND mes.meschave =:meschave'
      'AND mes.mesrefeicao = 0'
      'AND mes.etdcodigo = etd.etdcodigo'
      'AND mes.sdecodigo <> '#39'02'#39
      'AND rfi.tficodigo = 10)'
      ''
      '-- Filtros  ')
    Left = 952
    Top = 495
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'flacodigo'
        Value = nil
      end
      item
        DataType = ftUnknown
        Name = 'meschave'
        Value = nil
      end>
  end
  object tit: TUniQuery
    SQL.Strings = (
      'SELECT tit.titcodigo FROM tit '
      '  INNER JOIN rfi ON tit.titcodigo = rfi.titcodigo'
      '  INNER JOIN rfm ON rfi.rfichave = rfm.rfichave'
      '  INNER JOIN mes ON rfm.meschave = mes.meschave'
      'where mes.meschave=:meschave'
      'and mes.flacodigo=:flacodigo')
    Left = 952
    Top = 547
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'meschave'
        Value = nil
      end
      item
        DataType = ftUnknown
        Name = 'flacodigo'
        Value = nil
      end>
    object tittitcodigo: TIntegerField
      FieldName = 'titcodigo'
    end
  end
end
